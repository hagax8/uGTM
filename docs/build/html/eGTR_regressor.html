

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>eGTR: GTM regressor &mdash; ugtm v2.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/altair-plot.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/vega@3"></script>
        <script src="https://cdn.jsdelivr.net/npm/vega-lite@2"></script>
        <script src="https://cdn.jsdelivr.net/npm/vega-embed@3"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API Reference" href="api.html" />
    <link rel="prev" title="eGTC: GTM classifier" href="eGTC_classifier.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> ugtm
          

          
          </a>

          
            
            
              <div class="version">
                2.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Get started here</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="eGTM_transformer.html">eGTM: GTM transformer</a></li>
<li class="toctree-l1"><a class="reference internal" href="eGTC_classifier.html">eGTC: GTM classifier</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">eGTR: GTM regressor</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#run-egtr">Run eGTR</a></li>
<li class="toctree-l2"><a class="reference internal" href="#visualize-activity-landscape">Visualize activity landscape</a></li>
<li class="toctree-l2"><a class="reference internal" href="#visualize-predicted-vs-real-labels">Visualize predicted vs real labels</a></li>
<li class="toctree-l2"><a class="reference internal" href="#parameter-optimization">Parameter optimization</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">API reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="visualization_examples.html">Visualization examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="classification_examples.html">Classification examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="regression_examples.html">Regression examples</a></li>
</ul>
<p class="caption"><span class="caption-text">Advanced functions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="readme.html">tutorial</a></li>
</ul>
<p class="caption"><span class="caption-text">Glossary</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
</ul>
<p class="caption"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="references.html">Links &amp; references</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ugtm</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>eGTR: GTM regressor</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/eGTR_regressor.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="egtr-gtm-regressor">
<h1>eGTR: GTM regressor<a class="headerlink" href="#egtr-gtm-regressor" title="Permalink to this headline">¶</a></h1>
<div class="section" id="run-egtr">
<h2>Run eGTR<a class="headerlink" href="#run-egtr" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="ugtm.html#ugtm.ugtm_sklearn.eGTR" title="ugtm.ugtm_sklearn.eGTR"><code class="xref py py-class docutils literal notranslate"><span class="pre">eGTR</span></code></a> is a sklearn-compatible GTM regressor. Similarly to PCA or t-SNE, GTM reduces the dimensionality from n_dimensions to 2 dimensions. GTR uses a GTM class map to predict labels for new data (cf. <code class="xref py py-func docutils literal notranslate"><span class="pre">landscape()</span></code>). The following example uses the iris dataset:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ugtm</span> <span class="kn">import</span> <span class="n">eGTR</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">preprocessing</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">decomposition</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">model_selection</span>

<span class="n">boston</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_boston</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">boston</span><span class="o">.</span><span class="n">data</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">boston</span><span class="o">.</span><span class="n">target</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.33</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># optional preprocessing</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">StandardScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Predict labels for X_test</span>
<span class="n">gtr</span> <span class="o">=</span> <span class="n">eGTR</span><span class="p">()</span>
<span class="n">gtr</span> <span class="o">=</span> <span class="n">gtr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">gtr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="visualize-activity-landscape">
<h2>Visualize activity landscape<a class="headerlink" href="#visualize-activity-landscape" title="Permalink to this headline">¶</a></h2>
<p>The GTR algorithm is based on an activity landscape. This landscape is discretized into a grid of nodes,
which can be colored by predicted label. This visualization uses the python package <a class="reference external" href="https://altair-viz.github.io">altair</a>:</p>
<div class="highlight-python notranslate" id="eGTR_regressor-rst-altair-source-0"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ugtm</span> <span class="kn">import</span> <span class="n">eGTR</span><span class="p">,</span> <span class="n">eGTM</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">preprocessing</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">decomposition</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">model_selection</span>

<span class="n">boston</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_boston</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">boston</span><span class="o">.</span><span class="n">data</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">boston</span><span class="o">.</span><span class="n">target</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.33</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># optional preprocessing</span>
<span class="n">std</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">std</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>

<span class="c1"># Construct activity landscape</span>
<span class="n">gtr</span> <span class="o">=</span> <span class="n">eGTR</span><span class="p">()</span>
<span class="n">gtr</span> <span class="o">=</span> <span class="n">gtr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>

<span class="n">dfclassmap</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">gtr</span><span class="o">.</span><span class="n">optimizedModel</span><span class="o">.</span><span class="n">matX</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;x1&quot;</span><span class="p">,</span> <span class="s2">&quot;x2&quot;</span><span class="p">])</span>
<span class="n">dfclassmap</span><span class="p">[</span><span class="s2">&quot;predicted_node_label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gtr</span><span class="o">.</span><span class="n">node_label</span>

<span class="c1"># Classification map</span>
<span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">dfclassmap</span><span class="p">)</span><span class="o">.</span><span class="n">mark_square</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;x2&#39;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s1">&#39;predicted_node_label:Q&#39;</span><span class="p">,</span>
                    <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">scheme</span><span class="o">=</span><span class="s1">&#39;greenblue&#39;</span><span class="p">),</span>
                    <span class="n">legend</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Boston house prices&quot;</span><span class="p">)),</span>
    <span class="n">size</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span><span class="s1">&#39;x2&#39;</span><span class="p">,</span> <span class="s1">&#39;predicted_node_label:Q&#39;</span><span class="p">]</span>
<span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Activity landscape&quot;</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>

<div id="eGTR_regressor-rst-altair-plot-0">
<script>
  // embed when document is loaded, to ensure vega library is available
  // this works on all modern browsers, except IE8 and older
  document.addEventListener("DOMContentLoaded", function(event) {
      var spec = {"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "data": {"name": "data-9ba2ebbcccd3cd83b0909cee804c9d8c"}, "mark": "square", "encoding": {"color": {"type": "quantitative", "field": "predicted_node_label", "legend": {"title": "Boston house prices"}, "scale": {"scheme": "greenblue"}}, "size": {"value": 50}, "tooltip": [{"type": "quantitative", "field": "x1"}, {"type": "quantitative", "field": "x2"}, {"type": "quantitative", "field": "predicted_node_label"}], "x": {"type": "quantitative", "field": "x1"}, "y": {"type": "quantitative", "field": "x2"}}, "height": 200, "title": "Activity landscape", "width": 200, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-9ba2ebbcccd3cd83b0909cee804c9d8c": [{"x1": -1.0, "x2": -1.0, "predicted_node_label": 18.62848719571085}, {"x1": -1.0, "x2": -0.8666666666666667, "predicted_node_label": 22.798747646106925}, {"x1": -1.0, "x2": -0.7333333333333334, "predicted_node_label": 26.606108214896306}, {"x1": -1.0, "x2": -0.6, "predicted_node_label": 32.58064913174912}, {"x1": -1.0, "x2": -0.4666666666666667, "predicted_node_label": 40.69796574038217}, {"x1": -1.0, "x2": -0.33333333333333337, "predicted_node_label": 47.652519975384756}, {"x1": -1.0, "x2": -0.19999999999999996, "predicted_node_label": 42.761787021041044}, {"x1": -1.0, "x2": -0.06666666666666665, "predicted_node_label": 35.16692496641026}, {"x1": -1.0, "x2": 0.06666666666666665, "predicted_node_label": 32.353838052102056}, {"x1": -1.0, "x2": 0.19999999999999996, "predicted_node_label": 32.53406818649239}, {"x1": -1.0, "x2": 0.33333333333333326, "predicted_node_label": 26.48351354951699}, {"x1": -1.0, "x2": 0.46666666666666656, "predicted_node_label": 23.416631627426074}, {"x1": -1.0, "x2": 0.6000000000000001, "predicted_node_label": 32.64337685911035}, {"x1": -1.0, "x2": 0.7333333333333334, "predicted_node_label": 21.87638305216561}, {"x1": -1.0, "x2": 0.8666666666666667, "predicted_node_label": 22.661217944550646}, {"x1": -1.0, "x2": 1.0, "predicted_node_label": 25.958453052529013}, {"x1": -0.8666666666666667, "x2": -1.0, "predicted_node_label": 18.623090137150403}, {"x1": -0.8666666666666667, "x2": -0.8666666666666667, "predicted_node_label": 19.50382754329233}, {"x1": -0.8666666666666667, "x2": -0.7333333333333334, "predicted_node_label": 23.441674312838394}, {"x1": -0.8666666666666667, "x2": -0.6, "predicted_node_label": 26.312967404443445}, {"x1": -0.8666666666666667, "x2": -0.4666666666666667, "predicted_node_label": 32.72337778350308}, {"x1": -0.8666666666666667, "x2": -0.33333333333333337, "predicted_node_label": 34.86307363115382}, {"x1": -0.8666666666666667, "x2": -0.19999999999999996, "predicted_node_label": 36.02893940780538}, {"x1": -0.8666666666666667, "x2": -0.06666666666666665, "predicted_node_label": 33.44653760386411}, {"x1": -0.8666666666666667, "x2": 0.06666666666666665, "predicted_node_label": 30.031872185666444}, {"x1": -0.8666666666666667, "x2": 0.19999999999999996, "predicted_node_label": 26.419378782404085}, {"x1": -0.8666666666666667, "x2": 0.33333333333333326, "predicted_node_label": 25.353249355400806}, {"x1": -0.8666666666666667, "x2": 0.46666666666666656, "predicted_node_label": 22.53948570379749}, {"x1": -0.8666666666666667, "x2": 0.6000000000000001, "predicted_node_label": 31.85279270494944}, {"x1": -0.8666666666666667, "x2": 0.7333333333333334, "predicted_node_label": 32.66645308378407}, {"x1": -0.8666666666666667, "x2": 0.8666666666666667, "predicted_node_label": 25.969313196892113}, {"x1": -0.8666666666666667, "x2": 1.0, "predicted_node_label": 26.650727521230564}, {"x1": -0.7333333333333334, "x2": -1.0, "predicted_node_label": 21.112864102360106}, {"x1": -0.7333333333333334, "x2": -0.8666666666666667, "predicted_node_label": 19.852695836120414}, {"x1": -0.7333333333333334, "x2": -0.7333333333333334, "predicted_node_label": 23.484072991640073}, {"x1": -0.7333333333333334, "x2": -0.6, "predicted_node_label": 24.834030029049305}, {"x1": -0.7333333333333334, "x2": -0.4666666666666667, "predicted_node_label": 29.43156862123397}, {"x1": -0.7333333333333334, "x2": -0.33333333333333337, "predicted_node_label": 32.675955881362725}, {"x1": -0.7333333333333334, "x2": -0.19999999999999996, "predicted_node_label": 33.087909488427705}, {"x1": -0.7333333333333334, "x2": -0.06666666666666665, "predicted_node_label": 30.384176080523634}, {"x1": -0.7333333333333334, "x2": 0.06666666666666665, "predicted_node_label": 29.062809248396924}, {"x1": -0.7333333333333334, "x2": 0.19999999999999996, "predicted_node_label": 25.026940611401926}, {"x1": -0.7333333333333334, "x2": 0.33333333333333326, "predicted_node_label": 22.42456913303551}, {"x1": -0.7333333333333334, "x2": 0.46666666666666656, "predicted_node_label": 23.248112702126395}, {"x1": -0.7333333333333334, "x2": 0.6000000000000001, "predicted_node_label": 31.329556136036846}, {"x1": -0.7333333333333334, "x2": 0.7333333333333334, "predicted_node_label": 34.028273012283904}, {"x1": -0.7333333333333334, "x2": 0.8666666666666667, "predicted_node_label": 39.58737807842174}, {"x1": -0.7333333333333334, "x2": 1.0, "predicted_node_label": 49.511889530711244}, {"x1": -0.6, "x2": -1.0, "predicted_node_label": 21.253323958236408}, {"x1": -0.6, "x2": -0.8666666666666667, "predicted_node_label": 21.192075741420364}, {"x1": -0.6, "x2": -0.7333333333333334, "predicted_node_label": 22.401996391760708}, {"x1": -0.6, "x2": -0.6, "predicted_node_label": 24.639396204313726}, {"x1": -0.6, "x2": -0.4666666666666667, "predicted_node_label": 27.702741514045893}, {"x1": -0.6, "x2": -0.33333333333333337, "predicted_node_label": 29.0158627150527}, {"x1": -0.6, "x2": -0.19999999999999996, "predicted_node_label": 26.256118808748052}, {"x1": -0.6, "x2": -0.06666666666666665, "predicted_node_label": 25.439390549857084}, {"x1": -0.6, "x2": 0.06666666666666665, "predicted_node_label": 23.737939371008537}, {"x1": -0.6, "x2": 0.19999999999999996, "predicted_node_label": 21.599370032268432}, {"x1": -0.6, "x2": 0.33333333333333326, "predicted_node_label": 22.09777871905677}, {"x1": -0.6, "x2": 0.46666666666666656, "predicted_node_label": 30.90979022195221}, {"x1": -0.6, "x2": 0.6000000000000001, "predicted_node_label": 37.793025789687704}, {"x1": -0.6, "x2": 0.7333333333333334, "predicted_node_label": 43.28421871100063}, {"x1": -0.6, "x2": 0.8666666666666667, "predicted_node_label": 42.95355898799324}, {"x1": -0.6, "x2": 1.0, "predicted_node_label": 31.08861178964428}, {"x1": -0.4666666666666667, "x2": -1.0, "predicted_node_label": 23.759625947936332}, {"x1": -0.4666666666666667, "x2": -0.8666666666666667, "predicted_node_label": 23.342028686956112}, {"x1": -0.4666666666666667, "x2": -0.7333333333333334, "predicted_node_label": 22.83786309480897}, {"x1": -0.4666666666666667, "x2": -0.6, "predicted_node_label": 21.796401584782725}, {"x1": -0.4666666666666667, "x2": -0.4666666666666667, "predicted_node_label": 20.72303253128874}, {"x1": -0.4666666666666667, "x2": -0.33333333333333337, "predicted_node_label": 20.36932438279744}, {"x1": -0.4666666666666667, "x2": -0.19999999999999996, "predicted_node_label": 20.38791672812211}, {"x1": -0.4666666666666667, "x2": -0.06666666666666665, "predicted_node_label": 20.922083259404605}, {"x1": -0.4666666666666667, "x2": 0.06666666666666665, "predicted_node_label": 21.32358380190983}, {"x1": -0.4666666666666667, "x2": 0.19999999999999996, "predicted_node_label": 20.5330299444306}, {"x1": -0.4666666666666667, "x2": 0.33333333333333326, "predicted_node_label": 21.572465304979524}, {"x1": -0.4666666666666667, "x2": 0.46666666666666656, "predicted_node_label": 28.17939581984957}, {"x1": -0.4666666666666667, "x2": 0.6000000000000001, "predicted_node_label": 39.29434520614848}, {"x1": -0.4666666666666667, "x2": 0.7333333333333334, "predicted_node_label": 43.31057545509033}, {"x1": -0.4666666666666667, "x2": 0.8666666666666667, "predicted_node_label": 40.35403176166589}, {"x1": -0.4666666666666667, "x2": 1.0, "predicted_node_label": 23.2472982255592}, {"x1": -0.33333333333333337, "x2": -1.0, "predicted_node_label": 24.996915960745792}, {"x1": -0.33333333333333337, "x2": -0.8666666666666667, "predicted_node_label": 23.97404224547248}, {"x1": -0.33333333333333337, "x2": -0.7333333333333334, "predicted_node_label": 22.392536834383034}, {"x1": -0.33333333333333337, "x2": -0.6, "predicted_node_label": 21.623022625598992}, {"x1": -0.33333333333333337, "x2": -0.4666666666666667, "predicted_node_label": 20.672107273312495}, {"x1": -0.33333333333333337, "x2": -0.33333333333333337, "predicted_node_label": 20.297910238944112}, {"x1": -0.33333333333333337, "x2": -0.19999999999999996, "predicted_node_label": 19.700945549436188}, {"x1": -0.33333333333333337, "x2": -0.06666666666666665, "predicted_node_label": 21.113005055372756}, {"x1": -0.33333333333333337, "x2": 0.06666666666666665, "predicted_node_label": 20.105325790402922}, {"x1": -0.33333333333333337, "x2": 0.19999999999999996, "predicted_node_label": 19.729909236868036}, {"x1": -0.33333333333333337, "x2": 0.33333333333333326, "predicted_node_label": 21.589639543583367}, {"x1": -0.33333333333333337, "x2": 0.46666666666666656, "predicted_node_label": 27.404911251820796}, {"x1": -0.33333333333333337, "x2": 0.6000000000000001, "predicted_node_label": 35.787384036030744}, {"x1": -0.33333333333333337, "x2": 0.7333333333333334, "predicted_node_label": 43.4839062886573}, {"x1": -0.33333333333333337, "x2": 0.8666666666666667, "predicted_node_label": 45.91287170026032}, {"x1": -0.33333333333333337, "x2": 1.0, "predicted_node_label": 45.332069476400164}, {"x1": -0.19999999999999996, "x2": -1.0, "predicted_node_label": 26.222764352782033}, {"x1": -0.19999999999999996, "x2": -0.8666666666666667, "predicted_node_label": 24.4444937684694}, {"x1": -0.19999999999999996, "x2": -0.7333333333333334, "predicted_node_label": 21.158502130017837}, {"x1": -0.19999999999999996, "x2": -0.6, "predicted_node_label": 21.932385461995484}, {"x1": -0.19999999999999996, "x2": -0.4666666666666667, "predicted_node_label": 20.330006175615136}, {"x1": -0.19999999999999996, "x2": -0.33333333333333337, "predicted_node_label": 15.64054933749985}, {"x1": -0.19999999999999996, "x2": -0.19999999999999996, "predicted_node_label": 14.844723240839688}, {"x1": -0.19999999999999996, "x2": -0.06666666666666665, "predicted_node_label": 15.44523319401653}, {"x1": -0.19999999999999996, "x2": 0.06666666666666665, "predicted_node_label": 17.130997319409136}, {"x1": -0.19999999999999996, "x2": 0.19999999999999996, "predicted_node_label": 18.877272654851616}, {"x1": -0.19999999999999996, "x2": 0.33333333333333326, "predicted_node_label": 20.19792957259801}, {"x1": -0.19999999999999996, "x2": 0.46666666666666656, "predicted_node_label": 23.56887312140499}, {"x1": -0.19999999999999996, "x2": 0.6000000000000001, "predicted_node_label": 29.361471746725552}, {"x1": -0.19999999999999996, "x2": 0.7333333333333334, "predicted_node_label": 41.82670283561025}, {"x1": -0.19999999999999996, "x2": 0.8666666666666667, "predicted_node_label": 49.91867571361438}, {"x1": -0.19999999999999996, "x2": 1.0, "predicted_node_label": 49.999028802666956}, {"x1": -0.06666666666666665, "x2": -1.0, "predicted_node_label": 22.851541438191028}, {"x1": -0.06666666666666665, "x2": -0.8666666666666667, "predicted_node_label": 23.879567229036706}, {"x1": -0.06666666666666665, "x2": -0.7333333333333334, "predicted_node_label": 21.311076004137295}, {"x1": -0.06666666666666665, "x2": -0.6, "predicted_node_label": 21.746495606886985}, {"x1": -0.06666666666666665, "x2": -0.4666666666666667, "predicted_node_label": 17.018389446116117}, {"x1": -0.06666666666666665, "x2": -0.33333333333333337, "predicted_node_label": 14.735669063851788}, {"x1": -0.06666666666666665, "x2": -0.19999999999999996, "predicted_node_label": 13.424423119268134}, {"x1": -0.06666666666666665, "x2": -0.06666666666666665, "predicted_node_label": 13.305111427688466}, {"x1": -0.06666666666666665, "x2": 0.06666666666666665, "predicted_node_label": 16.804342873517548}, {"x1": -0.06666666666666665, "x2": 0.19999999999999996, "predicted_node_label": 19.057799224446068}, {"x1": -0.06666666666666665, "x2": 0.33333333333333326, "predicted_node_label": 18.459364587966466}, {"x1": -0.06666666666666665, "x2": 0.46666666666666656, "predicted_node_label": 21.549540990113435}, {"x1": -0.06666666666666665, "x2": 0.6000000000000001, "predicted_node_label": 26.24628333512891}, {"x1": -0.06666666666666665, "x2": 0.7333333333333334, "predicted_node_label": 45.81483465320872}, {"x1": -0.06666666666666665, "x2": 0.8666666666666667, "predicted_node_label": 38.33682210496212}, {"x1": -0.06666666666666665, "x2": 1.0, "predicted_node_label": 35.02141014497839}, {"x1": 0.06666666666666665, "x2": -1.0, "predicted_node_label": 21.891530278578298}, {"x1": 0.06666666666666665, "x2": -0.8666666666666667, "predicted_node_label": 21.582920810181335}, {"x1": 0.06666666666666665, "x2": -0.7333333333333334, "predicted_node_label": 18.686413427494987}, {"x1": 0.06666666666666665, "x2": -0.6, "predicted_node_label": 22.928000906800058}, {"x1": 0.06666666666666665, "x2": -0.4666666666666667, "predicted_node_label": 20.996885546300582}, {"x1": 0.06666666666666665, "x2": -0.33333333333333337, "predicted_node_label": 18.44894217577395}, {"x1": 0.06666666666666665, "x2": -0.19999999999999996, "predicted_node_label": 14.537034838619206}, {"x1": 0.06666666666666665, "x2": -0.06666666666666665, "predicted_node_label": 14.41676664550067}, {"x1": 0.06666666666666665, "x2": 0.06666666666666665, "predicted_node_label": 16.948573475187217}, {"x1": 0.06666666666666665, "x2": 0.19999999999999996, "predicted_node_label": 17.336306841792997}, {"x1": 0.06666666666666665, "x2": 0.33333333333333326, "predicted_node_label": 20.190254129257692}, {"x1": 0.06666666666666665, "x2": 0.46666666666666656, "predicted_node_label": 21.0582412654707}, {"x1": 0.06666666666666665, "x2": 0.6000000000000001, "predicted_node_label": 23.126016571093423}, {"x1": 0.06666666666666665, "x2": 0.7333333333333334, "predicted_node_label": 22.382720234771398}, {"x1": 0.06666666666666665, "x2": 0.8666666666666667, "predicted_node_label": 22.479579247469037}, {"x1": 0.06666666666666665, "x2": 1.0, "predicted_node_label": 22.210428367776263}, {"x1": 0.19999999999999996, "x2": -1.0, "predicted_node_label": 23.334516069941497}, {"x1": 0.19999999999999996, "x2": -0.8666666666666667, "predicted_node_label": 21.53343355070877}, {"x1": 0.19999999999999996, "x2": -0.7333333333333334, "predicted_node_label": 15.441130660043083}, {"x1": 0.19999999999999996, "x2": -0.6, "predicted_node_label": 13.66020451499212}, {"x1": 0.19999999999999996, "x2": -0.4666666666666667, "predicted_node_label": 21.689495658556424}, {"x1": 0.19999999999999996, "x2": -0.33333333333333337, "predicted_node_label": 22.944541219310302}, {"x1": 0.19999999999999996, "x2": -0.19999999999999996, "predicted_node_label": 15.484565882917463}, {"x1": 0.19999999999999996, "x2": -0.06666666666666665, "predicted_node_label": 14.381523809127788}, {"x1": 0.19999999999999996, "x2": 0.06666666666666665, "predicted_node_label": 14.57541475972099}, {"x1": 0.19999999999999996, "x2": 0.19999999999999996, "predicted_node_label": 16.373134224347787}, {"x1": 0.19999999999999996, "x2": 0.33333333333333326, "predicted_node_label": 18.893767020056327}, {"x1": 0.19999999999999996, "x2": 0.46666666666666656, "predicted_node_label": 20.85397910506906}, {"x1": 0.19999999999999996, "x2": 0.6000000000000001, "predicted_node_label": 20.407883379265993}, {"x1": 0.19999999999999996, "x2": 0.7333333333333334, "predicted_node_label": 20.13320260361498}, {"x1": 0.19999999999999996, "x2": 0.8666666666666667, "predicted_node_label": 15.797970794692219}, {"x1": 0.19999999999999996, "x2": 1.0, "predicted_node_label": 14.384250890303607}, {"x1": 0.33333333333333326, "x2": -1.0, "predicted_node_label": 22.355235616005697}, {"x1": 0.33333333333333326, "x2": -0.8666666666666667, "predicted_node_label": 24.69580841739386}, {"x1": 0.33333333333333326, "x2": -0.7333333333333334, "predicted_node_label": 11.725981250220793}, {"x1": 0.33333333333333326, "x2": -0.6, "predicted_node_label": 13.612981588106358}, {"x1": 0.33333333333333326, "x2": -0.4666666666666667, "predicted_node_label": 13.82137712910681}, {"x1": 0.33333333333333326, "x2": -0.33333333333333337, "predicted_node_label": 16.024340795592792}, {"x1": 0.33333333333333326, "x2": -0.19999999999999996, "predicted_node_label": 21.78091148852879}, {"x1": 0.33333333333333326, "x2": -0.06666666666666665, "predicted_node_label": 14.166806530523445}, {"x1": 0.33333333333333326, "x2": 0.06666666666666665, "predicted_node_label": 8.209045309586333}, {"x1": 0.33333333333333326, "x2": 0.19999999999999996, "predicted_node_label": 15.856056478532633}, {"x1": 0.33333333333333326, "x2": 0.33333333333333326, "predicted_node_label": 17.96938172153783}, {"x1": 0.33333333333333326, "x2": 0.46666666666666656, "predicted_node_label": 18.333151022957207}, {"x1": 0.33333333333333326, "x2": 0.6000000000000001, "predicted_node_label": 19.217746668454524}, {"x1": 0.33333333333333326, "x2": 0.7333333333333334, "predicted_node_label": 16.832579814847016}, {"x1": 0.33333333333333326, "x2": 0.8666666666666667, "predicted_node_label": 13.213584491357192}, {"x1": 0.33333333333333326, "x2": 1.0, "predicted_node_label": 13.155827610905614}, {"x1": 0.46666666666666656, "x2": -1.0, "predicted_node_label": 15.682380416959953}, {"x1": 0.46666666666666656, "x2": -0.8666666666666667, "predicted_node_label": 21.695507751091245}, {"x1": 0.46666666666666656, "x2": -0.7333333333333334, "predicted_node_label": 7.252418212553404}, {"x1": 0.46666666666666656, "x2": -0.6, "predicted_node_label": 9.181912374282799}, {"x1": 0.46666666666666656, "x2": -0.4666666666666667, "predicted_node_label": 13.610223364340746}, {"x1": 0.46666666666666656, "x2": -0.33333333333333337, "predicted_node_label": 13.798351782841918}, {"x1": 0.46666666666666656, "x2": -0.19999999999999996, "predicted_node_label": 13.768062404289516}, {"x1": 0.46666666666666656, "x2": -0.06666666666666665, "predicted_node_label": 9.077600423246956}, {"x1": 0.46666666666666656, "x2": 0.06666666666666665, "predicted_node_label": 8.179329693227032}, {"x1": 0.46666666666666656, "x2": 0.19999999999999996, "predicted_node_label": 15.564476490949335}, {"x1": 0.46666666666666656, "x2": 0.33333333333333326, "predicted_node_label": 18.689677677485726}, {"x1": 0.46666666666666656, "x2": 0.46666666666666656, "predicted_node_label": 18.32867775257417}, {"x1": 0.46666666666666656, "x2": 0.6000000000000001, "predicted_node_label": 18.385374100761474}, {"x1": 0.46666666666666656, "x2": 0.7333333333333334, "predicted_node_label": 19.982865765034106}, {"x1": 0.46666666666666656, "x2": 0.8666666666666667, "predicted_node_label": 14.014398251225087}, {"x1": 0.46666666666666656, "x2": 1.0, "predicted_node_label": 13.767707782789312}, {"x1": 0.6000000000000001, "x2": -1.0, "predicted_node_label": 13.972568128522484}, {"x1": 0.6000000000000001, "x2": -0.8666666666666667, "predicted_node_label": 23.061069386097106}, {"x1": 0.6000000000000001, "x2": -0.7333333333333334, "predicted_node_label": 16.374805387264306}, {"x1": 0.6000000000000001, "x2": -0.6, "predicted_node_label": 14.805298497624682}, {"x1": 0.6000000000000001, "x2": -0.4666666666666667, "predicted_node_label": 22.90626930682345}, {"x1": 0.6000000000000001, "x2": -0.33333333333333337, "predicted_node_label": 22.96996711001254}, {"x1": 0.6000000000000001, "x2": -0.19999999999999996, "predicted_node_label": 18.605497544237753}, {"x1": 0.6000000000000001, "x2": -0.06666666666666665, "predicted_node_label": 7.515585770700731}, {"x1": 0.6000000000000001, "x2": 0.06666666666666665, "predicted_node_label": 10.402439857723925}, {"x1": 0.6000000000000001, "x2": 0.19999999999999996, "predicted_node_label": 15.283879024677624}, {"x1": 0.6000000000000001, "x2": 0.33333333333333326, "predicted_node_label": 19.002211415316008}, {"x1": 0.6000000000000001, "x2": 0.46666666666666656, "predicted_node_label": 19.06832836964682}, {"x1": 0.6000000000000001, "x2": 0.6000000000000001, "predicted_node_label": 22.675030660581044}, {"x1": 0.6000000000000001, "x2": 0.7333333333333334, "predicted_node_label": 22.920769125520966}, {"x1": 0.6000000000000001, "x2": 0.8666666666666667, "predicted_node_label": 15.21624637943003}, {"x1": 0.6000000000000001, "x2": 1.0, "predicted_node_label": 14.337430509887884}, {"x1": 0.7333333333333334, "x2": -1.0, "predicted_node_label": 12.450484060191132}, {"x1": 0.7333333333333334, "x2": -0.8666666666666667, "predicted_node_label": 8.769434855482213}, {"x1": 0.7333333333333334, "x2": -0.7333333333333334, "predicted_node_label": 16.30082454228569}, {"x1": 0.7333333333333334, "x2": -0.6, "predicted_node_label": 22.970768558450008}, {"x1": 0.7333333333333334, "x2": -0.4666666666666667, "predicted_node_label": 22.97079646017699}, {"x1": 0.7333333333333334, "x2": -0.33333333333333337, "predicted_node_label": 22.97079646017699}, {"x1": 0.7333333333333334, "x2": -0.19999999999999996, "predicted_node_label": 22.97079646017699}, {"x1": 0.7333333333333334, "x2": -0.06666666666666665, "predicted_node_label": 22.617562778991367}, {"x1": 0.7333333333333334, "x2": 0.06666666666666665, "predicted_node_label": 9.505338875234958}, {"x1": 0.7333333333333334, "x2": 0.19999999999999996, "predicted_node_label": 15.041385433800562}, {"x1": 0.7333333333333334, "x2": 0.33333333333333326, "predicted_node_label": 19.194806365770265}, {"x1": 0.7333333333333334, "x2": 0.46666666666666656, "predicted_node_label": 21.88278454642761}, {"x1": 0.7333333333333334, "x2": 0.6000000000000001, "predicted_node_label": 22.9446452292087}, {"x1": 0.7333333333333334, "x2": 0.7333333333333334, "predicted_node_label": 18.068901574289722}, {"x1": 0.7333333333333334, "x2": 0.8666666666666667, "predicted_node_label": 16.893573356831848}, {"x1": 0.7333333333333334, "x2": 1.0, "predicted_node_label": 17.318891182738778}, {"x1": 0.8666666666666667, "x2": -1.0, "predicted_node_label": 8.988282844207195}, {"x1": 0.8666666666666667, "x2": -0.8666666666666667, "predicted_node_label": 7.817364470719962}, {"x1": 0.8666666666666667, "x2": -0.7333333333333334, "predicted_node_label": 10.955842013752658}, {"x1": 0.8666666666666667, "x2": -0.6, "predicted_node_label": 22.946060297260644}, {"x1": 0.8666666666666667, "x2": -0.4666666666666667, "predicted_node_label": 22.97065096518438}, {"x1": 0.8666666666666667, "x2": -0.33333333333333337, "predicted_node_label": 18.23924395074042}, {"x1": 0.8666666666666667, "x2": -0.19999999999999996, "predicted_node_label": 22.970790392230214}, {"x1": 0.8666666666666667, "x2": -0.06666666666666665, "predicted_node_label": 22.97079646017699}, {"x1": 0.8666666666666667, "x2": 0.06666666666666665, "predicted_node_label": 10.877734749347848}, {"x1": 0.8666666666666667, "x2": 0.19999999999999996, "predicted_node_label": 15.3081986978954}, {"x1": 0.8666666666666667, "x2": 0.33333333333333326, "predicted_node_label": 19.2649362412047}, {"x1": 0.8666666666666667, "x2": 0.46666666666666656, "predicted_node_label": 22.78904840599031}, {"x1": 0.8666666666666667, "x2": 0.6000000000000001, "predicted_node_label": 22.970200907960805}, {"x1": 0.8666666666666667, "x2": 0.7333333333333334, "predicted_node_label": 19.25240418742518}, {"x1": 0.8666666666666667, "x2": 0.8666666666666667, "predicted_node_label": 25.142393631999653}, {"x1": 0.8666666666666667, "x2": 1.0, "predicted_node_label": 34.05693858822945}, {"x1": 1.0, "x2": -1.0, "predicted_node_label": 7.852422282218054}, {"x1": 1.0, "x2": -0.8666666666666667, "predicted_node_label": 7.365340695875229}, {"x1": 1.0, "x2": -0.7333333333333334, "predicted_node_label": 13.153844787189467}, {"x1": 1.0, "x2": -0.6, "predicted_node_label": 22.955708219391195}, {"x1": 1.0, "x2": -0.4666666666666667, "predicted_node_label": 11.191836198137796}, {"x1": 1.0, "x2": -0.33333333333333337, "predicted_node_label": 10.40042644864298}, {"x1": 1.0, "x2": -0.19999999999999996, "predicted_node_label": 12.151099984701544}, {"x1": 1.0, "x2": -0.06666666666666665, "predicted_node_label": 22.97079646017699}, {"x1": 1.0, "x2": 0.06666666666666665, "predicted_node_label": 12.79683067179146}, {"x1": 1.0, "x2": 0.19999999999999996, "predicted_node_label": 14.988382787493533}, {"x1": 1.0, "x2": 0.33333333333333326, "predicted_node_label": 18.991133478386924}, {"x1": 1.0, "x2": 0.46666666666666656, "predicted_node_label": 22.965332436275048}, {"x1": 1.0, "x2": 0.6000000000000001, "predicted_node_label": 22.970763651685225}, {"x1": 1.0, "x2": 0.7333333333333334, "predicted_node_label": 26.135114922359367}, {"x1": 1.0, "x2": 0.8666666666666667, "predicted_node_label": 42.309841069650304}, {"x1": 1.0, "x2": 1.0, "predicted_node_label": 33.59411422263779}]}};
      var opt = {
        "mode": "vega-lite",
        "renderer": "canvas",
        "actions": {"editor": false, "source": false, "export": false}
      };
      vegaEmbed('#eGTR_regressor-rst-altair-plot-0', spec, opt).catch(console.err);
  });
</script>
</div></div>
<div class="section" id="visualize-predicted-vs-real-labels">
<h2>Visualize predicted vs real labels<a class="headerlink" href="#visualize-predicted-vs-real-labels" title="Permalink to this headline">¶</a></h2>
<p>This visualization uses the python package <a class="reference external" href="https://altair-viz.github.io">altair</a>:</p>
<div class="highlight-python notranslate" id="eGTR_regressor-rst-altair-source-1"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ugtm</span> <span class="kn">import</span> <span class="n">eGTM</span><span class="p">,</span> <span class="n">eGTR</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">preprocessing</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">decomposition</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">model_selection</span>

<span class="n">boston</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_boston</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">boston</span><span class="o">.</span><span class="n">data</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">boston</span><span class="o">.</span><span class="n">target</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.33</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># optional preprocessing</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">StandardScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Predict labels for X_test</span>
<span class="n">gtr</span> <span class="o">=</span> <span class="n">eGTR</span><span class="p">()</span>
<span class="n">gtr</span> <span class="o">=</span> <span class="n">gtr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">gtr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Get GTM transform for X_test</span>
<span class="n">transformed</span> <span class="o">=</span> <span class="n">eGTM</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">transformed</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;x1&quot;</span><span class="p">,</span> <span class="s2">&quot;x2&quot;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;predicted_label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_pred</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;true_label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_test</span>

<span class="n">chart1</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
<span class="n">x</span><span class="o">=</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;x2&#39;</span><span class="p">,</span>
<span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">&quot;predicted_label:Q&quot;</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">scheme</span><span class="o">=</span><span class="s1">&#39;greenblue&#39;</span><span class="p">),</span>
                 <span class="n">legend</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Boston house prices&quot;</span><span class="p">)),</span>
<span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;x1&quot;</span><span class="p">,</span> <span class="s2">&quot;x2&quot;</span><span class="p">,</span> <span class="s2">&quot;predicted_label:Q&quot;</span><span class="p">,</span> <span class="s2">&quot;true_label:Q&quot;</span><span class="p">]</span>
<span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Pedicted labels&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>

<span class="n">chart2</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
<span class="n">x</span><span class="o">=</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;x2&#39;</span><span class="p">,</span>
<span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">&quot;true_label:Q&quot;</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">scheme</span><span class="o">=</span><span class="s1">&#39;greenblue&#39;</span><span class="p">),</span>
                <span class="n">legend</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Boston house prices&quot;</span><span class="p">)),</span>
<span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;x1&quot;</span><span class="p">,</span> <span class="s2">&quot;x2&quot;</span><span class="p">,</span> <span class="s2">&quot;predicted_label:Q&quot;</span><span class="p">,</span> <span class="s2">&quot;true_label:Q&quot;</span><span class="p">]</span>
<span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;True labels&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>

<span class="n">alt</span><span class="o">.</span><span class="n">hconcat</span><span class="p">(</span><span class="n">chart1</span><span class="p">,</span> <span class="n">chart2</span><span class="p">)</span>
</pre></div>
</div>

<div id="eGTR_regressor-rst-altair-plot-1">
<script>
  // embed when document is loaded, to ensure vega library is available
  // this works on all modern browsers, except IE8 and older
  document.addEventListener("DOMContentLoaded", function(event) {
      var spec = {"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "hconcat": [{"mark": "point", "encoding": {"color": {"type": "quantitative", "field": "predicted_label", "legend": {"title": "Boston house prices"}, "scale": {"scheme": "greenblue"}}, "tooltip": [{"type": "quantitative", "field": "x1"}, {"type": "quantitative", "field": "x2"}, {"type": "quantitative", "field": "predicted_label"}, {"type": "quantitative", "field": "true_label"}], "x": {"type": "quantitative", "field": "x1"}, "y": {"type": "quantitative", "field": "x2"}}, "height": 200, "selection": {"selector004": {"type": "interval", "bind": "scales", "encodings": ["x", "y"]}}, "title": "Pedicted labels", "width": 200}, {"mark": "point", "encoding": {"color": {"type": "quantitative", "field": "true_label", "legend": {"title": "Boston house prices"}, "scale": {"scheme": "greenblue"}}, "tooltip": [{"type": "quantitative", "field": "x1"}, {"type": "quantitative", "field": "x2"}, {"type": "quantitative", "field": "predicted_label"}, {"type": "quantitative", "field": "true_label"}], "x": {"type": "quantitative", "field": "x1"}, "y": {"type": "quantitative", "field": "x2"}}, "height": 200, "selection": {"selector005": {"type": "interval", "bind": "scales", "encodings": ["x", "y"]}}, "title": "True labels", "width": 200}], "data": {"name": "data-c5e041ec2adc3722d53b8099ab5e00ab"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-c5e041ec2adc3722d53b8099ab5e00ab": [{"x1": -0.27389800919533974, "x2": 0.4715903408611233, "predicted_label": 27.404911251817527, "true_label": 23.6}, {"x1": -0.8682985322025105, "x2": 0.7347143971992026, "predicted_label": 32.66645308378361, "true_label": 32.4}, {"x1": 0.4544440033617187, "x2": 0.2832739449043908, "predicted_label": 18.68967767748532, "true_label": 13.6}, {"x1": -0.33289053333154384, "x2": -0.9611618421137795, "predicted_label": 24.996915960745095, "true_label": 22.8}, {"x1": 0.8689181435817904, "x2": 0.18264199212338586, "predicted_label": 15.30819869789525, "true_label": 16.1}, {"x1": -0.2790455905152092, "x2": 0.16889394818117678, "predicted_label": 20.19792957259703, "true_label": 20.0}, {"x1": -0.2604006835477106, "x2": -0.08706786234349512, "predicted_label": 21.11300505537265, "true_label": 17.8}, {"x1": 0.26088603022405366, "x2": 0.1824797226289532, "predicted_label": 16.373134224346774, "true_label": 14.0}, {"x1": 0.2785711450612485, "x2": -0.9348627813003746, "predicted_label": 22.355235616006247, "true_label": 19.6}, {"x1": -0.18093641985544945, "x2": 0.20225687970087228, "predicted_label": 18.87727265485172, "true_label": 16.8}, {"x1": -0.9993711049083108, "x2": 0.8806384345600047, "predicted_label": 22.661217944550206, "true_label": 21.5}, {"x1": -0.3449261620649596, "x2": -0.3456392236020206, "predicted_label": 20.29791023894415, "true_label": 18.9}, {"x1": 0.7429505982340314, "x2": -0.6098183039313901, "predicted_label": 22.970768558445414, "true_label": 7.0}, {"x1": -0.22033152617679624, "x2": -0.6960065906120375, "predicted_label": 21.158502130019684, "true_label": 21.2}, {"x1": -0.3596293590821712, "x2": 0.12879953631804605, "predicted_label": 20.105325790403608, "true_label": 18.5}, {"x1": 0.3013171052829131, "x2": -0.9993414608971206, "predicted_label": 22.355235616006247, "true_label": 29.8}, {"x1": 0.17522016579183372, "x2": 0.3805409931692019, "predicted_label": 20.85397910506796, "true_label": 18.8}, {"x1": 0.4160012953952298, "x2": -0.6002923984780559, "predicted_label": 9.181912374285291, "true_label": 10.2}, {"x1": -0.9709099506377518, "x2": -0.27404376089349997, "predicted_label": 42.76178702103677, "true_label": 50.0}, {"x1": 0.8863877847497792, "x2": 0.19444928271874712, "predicted_label": 15.30819869789525, "true_label": 14.1}, {"x1": -0.393249313999926, "x2": -0.9704215784028957, "predicted_label": 24.996915960745095, "true_label": 25.2}, {"x1": -0.6594032393770493, "x2": -0.10212103656635745, "predicted_label": 25.439390549857546, "true_label": 29.1}, {"x1": -0.1838451382440334, "x2": -0.021107845855860667, "predicted_label": 15.445233194016192, "true_label": 12.7}, {"x1": -0.158244161443836, "x2": 0.3574657371904755, "predicted_label": 20.19792957259703, "true_label": 22.4}, {"x1": 0.7104921759095068, "x2": -0.20261240030534677, "predicted_label": 15.30819869789525, "true_label": 14.2}, {"x1": 0.3473314179519911, "x2": -0.7976036232619783, "predicted_label": 24.695808417392083, "true_label": 13.8}, {"x1": -0.19900747615460787, "x2": -0.8478171744058407, "predicted_label": 24.444493768467552, "true_label": 20.3}, {"x1": 0.7449516257800654, "x2": -0.9999942613328922, "predicted_label": 12.450484060191988, "true_label": 14.9}, {"x1": -0.9996355172078599, "x2": 0.8444647426728901, "predicted_label": 22.661217944550206, "true_label": 21.7}, {"x1": -0.19319255904286606, "x2": 0.024246474398639972, "predicted_label": 18.87727265485172, "true_label": 18.3}, {"x1": -0.3248984878939562, "x2": -0.1289803472202495, "predicted_label": 21.11300505537265, "true_label": 23.1}, {"x1": -0.4899624750631193, "x2": 0.3273589698451487, "predicted_label": 21.57246530497894, "true_label": 23.8}, {"x1": 0.9796779470502927, "x2": 0.14245325873917175, "predicted_label": 14.988382787493713, "true_label": 15.0}, {"x1": 0.3387807680138848, "x2": -0.8516627274361046, "predicted_label": 24.695808417392083, "true_label": 20.8}, {"x1": 0.660880901876116, "x2": -0.09754267743242172, "predicted_label": 15.04138543379745, "true_label": 19.1}, {"x1": 0.20032961528338014, "x2": 0.8647373410712409, "predicted_label": 15.797970794694658, "true_label": 19.4}, {"x1": -0.4698616856600163, "x2": 0.563856869567176, "predicted_label": 39.2943452061465, "true_label": 34.7}, {"x1": -0.5083344326317597, "x2": 0.24520060420217257, "predicted_label": 20.533029944431185, "true_label": 19.5}, {"x1": -0.999305715522459, "x2": 0.736443416807675, "predicted_label": 21.87638305217167, "true_label": 24.4}, {"x1": -0.3343507600347122, "x2": -0.9667730793715912, "predicted_label": 24.996915960745095, "true_label": 23.4}, {"x1": -0.09531513211375342, "x2": -0.4423110001343991, "predicted_label": 21.746495606887088, "true_label": 19.7}, {"x1": -0.4632654450202845, "x2": 0.40977441967362377, "predicted_label": 28.179395819845855, "true_label": 28.2}, {"x1": -0.99752304509011, "x2": -0.3085823772639657, "predicted_label": 47.65251997538084, "true_label": 50.0}, {"x1": -0.45246704219661366, "x2": -0.4845392304884453, "predicted_label": 22.392536834383286, "true_label": 17.4}, {"x1": -0.3767357821410332, "x2": 0.40565556670125763, "predicted_label": 27.404911251817527, "true_label": 22.6}, {"x1": 0.6522253239928129, "x2": -0.16530072205560206, "predicted_label": 15.30819869789525, "true_label": 15.1}, {"x1": -0.19328784202417054, "x2": 0.06434749490967963, "predicted_label": 17.13099731941012, "true_label": 13.1}, {"x1": -0.3302263626287262, "x2": -0.9778433768845828, "predicted_label": 24.996915960745095, "true_label": 24.2}, {"x1": 0.29580695054418593, "x2": -0.8273991509522721, "predicted_label": 24.695808417392083, "true_label": 19.9}, {"x1": -0.5503697671541254, "x2": -0.15964260605202651, "predicted_label": 26.25611880874759, "true_label": 24.0}, {"x1": -0.40505163861176674, "x2": -0.32765543475313597, "predicted_label": 20.369324382797643, "true_label": 18.9}, {"x1": -0.6103680010530563, "x2": -0.30735183995998616, "predicted_label": 29.015862715051963, "true_label": 35.4}, {"x1": -0.20827320313334993, "x2": 0.091113444654188, "predicted_label": 17.13099731941012, "true_label": 15.2}, {"x1": -0.25535059530808274, "x2": 0.40363286748554156, "predicted_label": 23.568873121403094, "true_label": 26.5}, {"x1": -0.1997579731703398, "x2": 0.8198372947277978, "predicted_label": 49.91867571360982, "true_label": 43.5}, {"x1": 0.21483323794185444, "x2": -0.9868767831964453, "predicted_label": 23.334516069940687, "true_label": 21.2}, {"x1": 0.8804898076301617, "x2": 0.19558336456685593, "predicted_label": 15.30819869789525, "true_label": 18.4}, {"x1": -0.9818636277391972, "x2": -0.010351797676662153, "predicted_label": 32.35383805210075, "true_label": 28.5}, {"x1": -0.5285757854427636, "x2": 0.23966573515174663, "predicted_label": 22.09777871905649, "true_label": 23.9}, {"x1": -0.363377268591647, "x2": -0.28649018427229694, "predicted_label": 20.29791023894415, "true_label": 18.5}, {"x1": -0.8609064856924399, "x2": 0.302072782984712, "predicted_label": 26.483513549520392, "true_label": 25.0}, {"x1": -0.9885459868675298, "x2": -0.6691369166505973, "predicted_label": 26.606108214894164, "true_label": 35.4}, {"x1": -0.213594083102388, "x2": -0.9852496627169962, "predicted_label": 26.22276435278103, "true_label": 31.5}, {"x1": -0.3583959935027076, "x2": 0.07530310681636739, "predicted_label": 19.729909236868487, "true_label": 20.2}, {"x1": -0.8906634777621365, "x2": -0.8560621134895798, "predicted_label": 19.503827543294186, "true_label": 24.1}, {"x1": -0.9999991180874064, "x2": 0.8631864953773977, "predicted_label": 22.661217944550206, "true_label": 20.0}, {"x1": 0.9184239799695898, "x2": 0.1987394491498426, "predicted_label": 15.30819869789525, "true_label": 13.1}, {"x1": -0.6651187523113434, "x2": 0.06931148723824276, "predicted_label": 25.0269406114042, "true_label": 24.8}, {"x1": -0.9307441334148079, "x2": -0.0894751711824998, "predicted_label": 32.35383805210075, "true_label": 30.8}, {"x1": 0.7396863311268688, "x2": -0.999999847473274, "predicted_label": 12.450484060191988, "true_label": 12.7}, {"x1": -0.3235379113645061, "x2": -0.7111669838256631, "predicted_label": 22.392536834383286, "true_label": 20.0}, {"x1": 0.23649565944146334, "x2": -0.9999019885650559, "predicted_label": 23.334516069940687, "true_label": 23.7}, {"x1": 0.575335111360528, "x2": -0.8443088403469992, "predicted_label": 23.061069386091994, "true_label": 10.8}, {"x1": -0.955152556186686, "x2": -0.9910111586167019, "predicted_label": 18.628487195713195, "true_label": 20.6}, {"x1": -0.18392038814926037, "x2": -0.8234980515759996, "predicted_label": 24.444493768467552, "true_label": 20.8}, {"x1": 0.6070220768669214, "x2": -0.2811035293098509, "predicted_label": 18.605497544231515, "true_label": 5.0}, {"x1": -0.18777895840689085, "x2": 0.2546012355757791, "predicted_label": 18.87727265485172, "true_label": 20.1}, {"x1": -0.9950916704588578, "x2": -0.3212903834716473, "predicted_label": 47.65251997538084, "true_label": 48.5}, {"x1": 0.925163476532509, "x2": 0.18390661787844945, "predicted_label": 14.988382787493713, "true_label": 10.9}, {"x1": 0.4092542685263962, "x2": 0.16846984386160188, "predicted_label": 15.5644764909495, "true_label": 7.0}, {"x1": -0.5934929692484753, "x2": -0.20406171450872046, "predicted_label": 22.424569133036975, "true_label": 20.9}, {"x1": 0.3565352039678292, "x2": -0.7300242096242723, "predicted_label": 11.725981250222882, "true_label": 17.2}, {"x1": -0.8747278862868131, "x2": -0.7552130410679558, "predicted_label": 23.441674312840174, "true_label": 20.9}, {"x1": 0.344307125471522, "x2": -0.7244592734108446, "predicted_label": 11.725981250222882, "true_label": 9.7}, {"x1": -0.20708690089362378, "x2": 0.2567940284756649, "predicted_label": 20.19792957259703, "true_label": 19.4}, {"x1": -0.8696184940257108, "x2": 0.8525533530984346, "predicted_label": 25.96931319689588, "true_label": 29.0}, {"x1": 0.5118487486838815, "x2": -0.9593267518734436, "predicted_label": 15.682380416963706, "true_label": 16.4}, {"x1": -0.497709146484453, "x2": 0.10174651208899783, "predicted_label": 22.09777871905649, "true_label": 25.0}, {"x1": -0.25872423190438265, "x2": -0.969945879207918, "predicted_label": 26.22276435278103, "true_label": 25.0}, {"x1": 0.22030967747441607, "x2": 0.3201286626350939, "predicted_label": 18.89376702005491, "true_label": 17.1}, {"x1": -0.3043098133571597, "x2": -0.6073105049621654, "predicted_label": 21.623022625599088, "true_label": 23.2}, {"x1": 0.7182854142988128, "x2": -0.7366143284648122, "predicted_label": 16.30082454228573, "true_label": 10.4}, {"x1": 0.19841730319085452, "x2": 0.33506659692861634, "predicted_label": 18.89376702005491, "true_label": 19.6}, {"x1": -0.5902456434706322, "x2": 0.10411477476074542, "predicted_label": 21.599370032269636, "true_label": 17.2}, {"x1": 0.31820909967991684, "x2": -0.7401330502394003, "predicted_label": 11.725981250222882, "true_label": 27.5}, {"x1": 0.189489973821271, "x2": 0.3424561880089038, "predicted_label": 18.89376702005491, "true_label": 23.0}, {"x1": 0.38627399858046807, "x2": -0.8901842522443871, "predicted_label": 22.355235616006247, "true_label": 50.0}, {"x1": 0.8480309750596031, "x2": -0.8666668073896702, "predicted_label": 7.817364470720498, "true_label": 17.9}, {"x1": 0.7406291209197412, "x2": -0.978110343952924, "predicted_label": 12.450484060191988, "true_label": 9.6}, {"x1": 0.7416301487582394, "x2": -0.9869898128631298, "predicted_label": 12.450484060191988, "true_label": 17.2}, {"x1": -0.4121798916467912, "x2": -0.18201223265084562, "predicted_label": 20.533029944431185, "true_label": 22.5}, {"x1": -0.19185599169566703, "x2": -0.8681548720722952, "predicted_label": 24.444493768467552, "true_label": 21.4}, {"x1": 0.45691470285436625, "x2": -0.7311653966544719, "predicted_label": 7.252418212555921, "true_label": 12.0}, {"x1": -0.4107144126416841, "x2": 0.24042461610070892, "predicted_label": 20.533029944431185, "true_label": 19.9}, {"x1": -0.5859059128550318, "x2": -0.7688196290293988, "predicted_label": 22.40199639176003, "true_label": 19.4}, {"x1": 0.7982869720298738, "x2": -0.9999981285650742, "predicted_label": 12.450484060191988, "true_label": 13.4}, {"x1": -0.2995449978091097, "x2": 0.20167945928385267, "predicted_label": 19.729909236868487, "true_label": 18.2}, {"x1": -0.3171089228006851, "x2": -0.9614217833965732, "predicted_label": 24.996915960745095, "true_label": 24.6}, {"x1": -0.6109535799212467, "x2": 0.288665816738233, "predicted_label": 22.09777871905649, "true_label": 21.1}, {"x1": -0.9628870311910432, "x2": -0.7369374263757332, "predicted_label": 26.606108214894164, "true_label": 24.7}, {"x1": 0.8644242690854673, "x2": -0.8844342876062659, "predicted_label": 7.817364470720498, "true_label": 8.7}, {"x1": 0.601106984403287, "x2": -0.9636698129891361, "predicted_label": 13.972568128527598, "true_label": 27.5}, {"x1": -0.6408184103741359, "x2": 0.32845786744627425, "predicted_label": 22.09777871905649, "true_label": 20.7}, {"x1": -0.3922299457720765, "x2": 0.3233240640661687, "predicted_label": 21.589639543583356, "true_label": 36.2}, {"x1": -0.26166802720986404, "x2": 0.5897022578852164, "predicted_label": 29.361471746732565, "true_label": 31.6}, {"x1": 0.7038641942134, "x2": -0.9268596142887587, "predicted_label": 8.769434855490251, "true_label": 11.7}, {"x1": -0.33606872052682135, "x2": 0.6015477781421139, "predicted_label": 35.78738403603272, "true_label": 39.8}, {"x1": -0.22330758420993083, "x2": 0.08420803662875401, "predicted_label": 17.13099731941012, "true_label": 13.9}, {"x1": -0.09075292284760302, "x2": -0.6354727130430031, "predicted_label": 21.31107600413721, "true_label": 21.8}, {"x1": -0.6081020760425071, "x2": -0.5466002336223147, "predicted_label": 22.40199639176003, "true_label": 23.7}, {"x1": -0.4985111155964181, "x2": -0.0024140969584319333, "predicted_label": 20.922083259404303, "true_label": 17.6}, {"x1": -0.8616136317061082, "x2": 0.22980871767259956, "predicted_label": 25.353249355401406, "true_label": 24.4}, {"x1": 0.9999918954945257, "x2": -0.5999999999689228, "predicted_label": 22.955708219391187, "true_label": 8.8}, {"x1": -0.163225233283005, "x2": 0.3411130536719555, "predicted_label": 20.19792957259703, "true_label": 19.2}, {"x1": -0.37192696195646135, "x2": -0.9319090873983189, "predicted_label": 23.97404224547212, "true_label": 25.3}, {"x1": -0.4830841922298216, "x2": 0.2392168054531182, "predicted_label": 21.57246530497894, "true_label": 20.4}, {"x1": -0.9741894616214827, "x2": -0.7346652500105709, "predicted_label": 26.606108214894164, "true_label": 23.1}, {"x1": -0.31173112584474155, "x2": 0.5870887916563166, "predicted_label": 35.78738403603272, "true_label": 37.9}, {"x1": 0.6000528714633209, "x2": 0.9992862830417232, "predicted_label": 14.33743050988838, "true_label": 15.6}, {"x1": -0.38805215715299, "x2": 0.7326242311544727, "predicted_label": 43.483906288652975, "true_label": 45.4}, {"x1": 0.1225050671674831, "x2": 0.07552101107437374, "predicted_label": 16.94857347518588, "true_label": 15.7}, {"x1": -0.3421897464570255, "x2": -0.8629616737871906, "predicted_label": 23.97404224547212, "true_label": 22.6}, {"x1": -0.23135135654800412, "x2": 0.17956055610815785, "predicted_label": 18.87727265485172, "true_label": 14.5}, {"x1": -0.19959997091904305, "x2": 0.01046028296954323, "predicted_label": 17.13099731941012, "true_label": 18.7}, {"x1": 0.22166647208192275, "x2": 0.9580751371478806, "predicted_label": 14.384250890304404, "true_label": 17.8}, {"x1": 0.6110454213714381, "x2": -0.9999985880954225, "predicted_label": 13.972568128527598, "true_label": 16.1}, {"x1": -0.539497169840639, "x2": 0.2646256852646092, "predicted_label": 22.09777871905649, "true_label": 20.6}, {"x1": -0.9792075692780798, "x2": -0.5993676574666172, "predicted_label": 32.58064913175369, "true_label": 31.6}, {"x1": -0.7561777603267616, "x2": -0.46242840356009446, "predicted_label": 24.834030029050137, "true_label": 29.1}, {"x1": -0.2249405950014312, "x2": 0.10324209818292135, "predicted_label": 17.13099731941012, "true_label": 15.6}, {"x1": -0.26739942779452164, "x2": 0.15630106792476806, "predicted_label": 18.87727265485172, "true_label": 17.5}, {"x1": -0.8174763495541294, "x2": -0.6047463515737237, "predicted_label": 26.31296740444697, "true_label": 22.5}, {"x1": -0.8441855709532086, "x2": -0.7076504997316784, "predicted_label": 23.441674312840174, "true_label": 19.4}, {"x1": -0.9999990240473013, "x2": 0.8592176360331228, "predicted_label": 22.661217944550206, "true_label": 19.3}, {"x1": 0.6709865610669975, "x2": -0.33286715742752737, "predicted_label": 22.617562778982872, "true_label": 8.5}, {"x1": -0.3150958803488266, "x2": 0.14652331317609923, "predicted_label": 20.922083259404303, "true_label": 20.6}, {"x1": 0.610218605992401, "x2": 0.9975011909811473, "predicted_label": 14.33743050988838, "true_label": 17.0}, {"x1": 0.9237735591503807, "x2": 0.1997510093209611, "predicted_label": 15.30819869789525, "true_label": 17.1}, {"x1": -0.18978955932575128, "x2": 0.03295356467122156, "predicted_label": 17.13099731941012, "true_label": 14.5}, {"x1": -0.3302338041400851, "x2": 0.7369797700566504, "predicted_label": 43.483906288652975, "true_label": 50.0}, {"x1": 0.6845129999705389, "x2": -0.9999959265153163, "predicted_label": 12.450484060191988, "true_label": 14.3}, {"x1": 0.9087846510532982, "x2": 0.19512403094833763, "predicted_label": 15.30819869789525, "true_label": 12.6}, {"x1": -0.5912118088284892, "x2": 0.3569916855587455, "predicted_label": 22.09777871905649, "true_label": 28.7}, {"x1": -0.16582337733946795, "x2": 0.160277732274795, "predicted_label": 20.19792957259703, "true_label": 21.2}, {"x1": -0.33084900446031806, "x2": -0.7567833710018669, "predicted_label": 22.392536834383286, "true_label": 19.3}, {"x1": -0.2766523819685104, "x2": -0.7040181105392533, "predicted_label": 26.22276435278103, "true_label": 23.1}, {"x1": 0.3740316829956503, "x2": -0.8521951954842847, "predicted_label": 24.695808417392083, "true_label": 19.1}, {"x1": 0.3468354961418137, "x2": -0.9746817693243804, "predicted_label": 22.355235616006247, "true_label": 25.0}, {"x1": -0.6027549195082087, "x2": 0.45372282650367546, "predicted_label": 30.909790221947254, "true_label": 33.4}, {"x1": 0.7674997932023031, "x2": -0.3020908088262928, "predicted_label": 22.97079646017699, "true_label": 5.0}, {"x1": -0.40988013860690226, "x2": 0.11684435062518875, "predicted_label": 21.323583801909386, "true_label": 29.6}, {"x1": -0.5733992483161655, "x2": 0.1445652321408375, "predicted_label": 21.599370032269636, "true_label": 18.7}, {"x1": -0.28017456684058084, "x2": 0.24895446307442332, "predicted_label": 19.729909236868487, "true_label": 21.7}, {"x1": -0.4826307456623198, "x2": 0.32350461382980983, "predicted_label": 21.57246530497894, "true_label": 23.1}, {"x1": 0.06389145850072771, "x2": 0.8876276081729906, "predicted_label": 22.479579247468983, "true_label": 22.8}, {"x1": -0.2684849838596713, "x2": 0.2948240805347845, "predicted_label": 20.19792957259703, "true_label": 21.0}, {"x1": -0.19900226587012618, "x2": 0.9835139076152359, "predicted_label": 49.999028802666906, "true_label": 48.8}]}};
      var opt = {
        "mode": "vega-lite",
        "renderer": "canvas",
        "actions": {"editor": false, "source": false, "export": false}
      };
      vegaEmbed('#eGTR_regressor-rst-altair-plot-1', spec, opt).catch(console.err);
  });
</script>
</div></div>
<div class="section" id="parameter-optimization">
<h2>Parameter optimization<a class="headerlink" href="#parameter-optimization" title="Permalink to this headline">¶</a></h2>
<p>GridSearchCV from sklearn can be used with eGTC for parameter optimization:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ugtm</span> <span class="kn">import</span> <span class="n">eGTR</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>

<span class="c1"># Dummy train and test</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># Parameters to tune</span>
<span class="n">tuned_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;regul&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0001</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span>
                <span class="s1">&#39;s&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span>
                <span class="s1">&#39;k&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">16</span><span class="p">],</span>
                <span class="s1">&#39;m&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">]}</span>

<span class="c1"># GTM classifier (GTR)</span>
<span class="n">gs</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">eGTR</span><span class="p">(),</span> <span class="n">tuned_params</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">iid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;r2&#39;</span><span class="p">)</span>
<span class="n">gs</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">gs</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="api.html" class="btn btn-neutral float-right" title="API Reference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="eGTC_classifier.html" class="btn btn-neutral float-left" title="eGTC: GTM classifier" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2018, Helena A. Gaspar.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>