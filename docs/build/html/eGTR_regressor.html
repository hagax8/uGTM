

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>eGTR: GTM regressor &mdash; ugtm v2.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/altair-plot.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/vega@3"></script>
        <script src="https://cdn.jsdelivr.net/npm/vega-lite@2"></script>
        <script src="https://cdn.jsdelivr.net/npm/vega-embed@3"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API Reference" href="api.html" />
    <link rel="prev" title="eGTC: GTM classifier" href="eGTC_classifier.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> ugtm
          

          
          </a>

          
            
            
              <div class="version">
                2.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Get started here</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="eGTM_transformer.html">eGTM: GTM transformer</a></li>
<li class="toctree-l1"><a class="reference internal" href="eGTC_classifier.html">eGTC: GTM classifier</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">eGTR: GTM regressor</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#run-egtr">Run eGTR</a></li>
<li class="toctree-l2"><a class="reference internal" href="#visualize-activity-landscape">Visualize activity landscape</a></li>
<li class="toctree-l2"><a class="reference internal" href="#visualize-predicted-vs-real-labels">Visualize predicted vs real labels</a></li>
<li class="toctree-l2"><a class="reference internal" href="#parameter-optimization">Parameter optimization</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">API reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="visualization_examples.html">Visualization examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="classification_examples.html">Classification examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="regression_examples.html">Regression examples</a></li>
</ul>
<p class="caption"><span class="caption-text">Advanced functions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="readme.html">tutorial</a></li>
</ul>
<p class="caption"><span class="caption-text">Glossary</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
</ul>
<p class="caption"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="references.html">Links &amp; references</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ugtm</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>eGTR: GTM regressor</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/eGTR_regressor.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="egtr-gtm-regressor">
<h1>eGTR: GTM regressor<a class="headerlink" href="#egtr-gtm-regressor" title="Permalink to this headline">¶</a></h1>
<div class="section" id="run-egtr">
<h2>Run eGTR<a class="headerlink" href="#run-egtr" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="ugtm.html#ugtm.ugtm_sklearn.eGTR" title="ugtm.ugtm_sklearn.eGTR"><code class="xref py py-class docutils literal notranslate"><span class="pre">eGTR</span></code></a> is a sklearn-compatible GTM regressor. Similarly to PCA or t-SNE, GTM reduces the dimensionality from n_dimensions to 2 dimensions. GTR uses a GTM class map to predict labels for new data (cf. <code class="xref py py-func docutils literal notranslate"><span class="pre">landscape()</span></code>). The following example uses the iris dataset:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ugtm</span> <span class="kn">import</span> <span class="n">eGTR</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">preprocessing</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">decomposition</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">model_selection</span>

<span class="n">boston</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_boston</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">boston</span><span class="o">.</span><span class="n">data</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">boston</span><span class="o">.</span><span class="n">target</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.33</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># optional preprocessing</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">StandardScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Predict labels for X_test</span>
<span class="n">gtr</span> <span class="o">=</span> <span class="n">eGTR</span><span class="p">()</span>
<span class="n">gtr</span> <span class="o">=</span> <span class="n">gtr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">gtr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="visualize-activity-landscape">
<h2>Visualize activity landscape<a class="headerlink" href="#visualize-activity-landscape" title="Permalink to this headline">¶</a></h2>
<p>The GTR algorithm is based on an activity landscape. This landscape is discretized into a grid of nodes,
which can be colored by predicted label. This visualization uses the python package <a class="reference external" href="https://altair-viz.github.io">altair</a>:</p>
<div class="highlight-python notranslate" id="eGTR_regressor-rst-altair-source-0"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ugtm</span> <span class="kn">import</span> <span class="n">eGTR</span><span class="p">,</span> <span class="n">eGTM</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">preprocessing</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">decomposition</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">model_selection</span>

<span class="n">boston</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_boston</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">boston</span><span class="o">.</span><span class="n">data</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">boston</span><span class="o">.</span><span class="n">target</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.33</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># optional preprocessing</span>
<span class="n">std</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">std</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>

<span class="c1"># Construct activity landscape</span>
<span class="n">gtr</span> <span class="o">=</span> <span class="n">eGTR</span><span class="p">()</span>
<span class="n">gtr</span> <span class="o">=</span> <span class="n">gtr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>

<span class="n">dfclassmap</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">gtr</span><span class="o">.</span><span class="n">optimizedModel</span><span class="o">.</span><span class="n">matX</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;x1&quot;</span><span class="p">,</span> <span class="s2">&quot;x2&quot;</span><span class="p">])</span>
<span class="n">dfclassmap</span><span class="p">[</span><span class="s2">&quot;predicted node label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gtr</span><span class="o">.</span><span class="n">node_label</span>

<span class="c1"># Classification map</span>
<span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">dfclassmap</span><span class="p">)</span><span class="o">.</span><span class="n">mark_square</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;x2&#39;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s1">&#39;predicted node label:Q&#39;</span><span class="p">,</span>
                    <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">scheme</span><span class="o">=</span><span class="s1">&#39;greenblue&#39;</span><span class="p">),</span>
                    <span class="n">legend</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Boston house prices&quot;</span><span class="p">)),</span>
    <span class="n">size</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span><span class="s1">&#39;x2&#39;</span><span class="p">,</span> <span class="s1">&#39;predicted node label:Q&#39;</span><span class="p">]</span>
<span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Activity landscape&quot;</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>

<div id="eGTR_regressor-rst-altair-plot-0">
<script>
  // embed when document is loaded, to ensure vega library is available
  // this works on all modern browsers, except IE8 and older
  document.addEventListener("DOMContentLoaded", function(event) {
      var spec = {"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "data": {"name": "data-47c6eba67bb22209204a30ea39cea81b"}, "mark": "square", "encoding": {"color": {"type": "quantitative", "field": "predicted node label", "legend": {"title": "Boston house prices"}, "scale": {"scheme": "greenblue"}}, "size": {"value": 50}, "tooltip": [{"type": "quantitative", "field": "x1"}, {"type": "quantitative", "field": "x2"}, {"type": "quantitative", "field": "predicted node label"}], "x": {"type": "quantitative", "field": "x1"}, "y": {"type": "quantitative", "field": "x2"}}, "height": 200, "title": "Activity landscape", "width": 200, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-47c6eba67bb22209204a30ea39cea81b": [{"x1": -1.0, "x2": -1.0, "predicted node label": 18.62848719571037}, {"x1": -1.0, "x2": -0.8666666666666667, "predicted node label": 22.798747646071433}, {"x1": -1.0, "x2": -0.7333333333333334, "predicted node label": 26.606108214893684}, {"x1": -1.0, "x2": -0.6, "predicted node label": 32.58064913174332}, {"x1": -1.0, "x2": -0.4666666666666667, "predicted node label": 40.69796574037025}, {"x1": -1.0, "x2": -0.33333333333333337, "predicted node label": 47.65251997538205}, {"x1": -1.0, "x2": -0.19999999999999996, "predicted node label": 42.761787021041705}, {"x1": -1.0, "x2": -0.06666666666666665, "predicted node label": 35.166924966413006}, {"x1": -1.0, "x2": 0.06666666666666665, "predicted node label": 32.353838052100215}, {"x1": -1.0, "x2": 0.19999999999999996, "predicted node label": 32.53406818649791}, {"x1": -1.0, "x2": 0.33333333333333326, "predicted node label": 26.483513549518023}, {"x1": -1.0, "x2": 0.46666666666666656, "predicted node label": 23.416631627424916}, {"x1": -1.0, "x2": 0.6000000000000001, "predicted node label": 32.64337685911344}, {"x1": -1.0, "x2": 0.7333333333333334, "predicted node label": 21.876383052165952}, {"x1": -1.0, "x2": 0.8666666666666667, "predicted node label": 22.661217944550362}, {"x1": -1.0, "x2": 1.0, "predicted node label": 25.95845305252722}, {"x1": -0.8666666666666667, "x2": -1.0, "predicted node label": 18.623090137148626}, {"x1": -0.8666666666666667, "x2": -0.8666666666666667, "predicted node label": 19.503827543282224}, {"x1": -0.8666666666666667, "x2": -0.7333333333333334, "predicted node label": 23.44167431283531}, {"x1": -0.8666666666666667, "x2": -0.6, "predicted node label": 26.312967404436833}, {"x1": -0.8666666666666667, "x2": -0.4666666666666667, "predicted node label": 32.72337778349651}, {"x1": -0.8666666666666667, "x2": -0.33333333333333337, "predicted node label": 34.8630736311486}, {"x1": -0.8666666666666667, "x2": -0.19999999999999996, "predicted node label": 36.028939407801225}, {"x1": -0.8666666666666667, "x2": -0.06666666666666665, "predicted node label": 33.4465376038657}, {"x1": -0.8666666666666667, "x2": 0.06666666666666665, "predicted node label": 30.031872185667414}, {"x1": -0.8666666666666667, "x2": 0.19999999999999996, "predicted node label": 26.419378782404497}, {"x1": -0.8666666666666667, "x2": 0.33333333333333326, "predicted node label": 25.35324935540038}, {"x1": -0.8666666666666667, "x2": 0.46666666666666656, "predicted node label": 22.539485703793925}, {"x1": -0.8666666666666667, "x2": 0.6000000000000001, "predicted node label": 31.852792704955057}, {"x1": -0.8666666666666667, "x2": 0.7333333333333334, "predicted node label": 32.66645308378262}, {"x1": -0.8666666666666667, "x2": 0.8666666666666667, "predicted node label": 25.969313196891083}, {"x1": -0.8666666666666667, "x2": 1.0, "predicted node label": 26.650727521229943}, {"x1": -0.7333333333333334, "x2": -1.0, "predicted node label": 21.112864102358216}, {"x1": -0.7333333333333334, "x2": -0.8666666666666667, "predicted node label": 19.852695836109202}, {"x1": -0.7333333333333334, "x2": -0.7333333333333334, "predicted node label": 23.484072991640115}, {"x1": -0.7333333333333334, "x2": -0.6, "predicted node label": 24.834030029043213}, {"x1": -0.7333333333333334, "x2": -0.4666666666666667, "predicted node label": 29.431568621229}, {"x1": -0.7333333333333334, "x2": -0.33333333333333337, "predicted node label": 32.67595588136014}, {"x1": -0.7333333333333334, "x2": -0.19999999999999996, "predicted node label": 33.08790948842791}, {"x1": -0.7333333333333334, "x2": -0.06666666666666665, "predicted node label": 30.38417608052488}, {"x1": -0.7333333333333334, "x2": 0.06666666666666665, "predicted node label": 29.062809248400693}, {"x1": -0.7333333333333334, "x2": 0.19999999999999996, "predicted node label": 25.02694061140189}, {"x1": -0.7333333333333334, "x2": 0.33333333333333326, "predicted node label": 22.424569133033142}, {"x1": -0.7333333333333334, "x2": 0.46666666666666656, "predicted node label": 23.24811270212591}, {"x1": -0.7333333333333334, "x2": 0.6000000000000001, "predicted node label": 31.329556136035684}, {"x1": -0.7333333333333334, "x2": 0.7333333333333334, "predicted node label": 34.0282730122837}, {"x1": -0.7333333333333334, "x2": 0.8666666666666667, "predicted node label": 39.587378078419995}, {"x1": -0.7333333333333334, "x2": 1.0, "predicted node label": 49.511889530710285}, {"x1": -0.6, "x2": -1.0, "predicted node label": 21.253323958242586}, {"x1": -0.6, "x2": -0.8666666666666667, "predicted node label": 21.192075741418616}, {"x1": -0.6, "x2": -0.7333333333333334, "predicted node label": 22.401996391756928}, {"x1": -0.6, "x2": -0.6, "predicted node label": 24.63939620431044}, {"x1": -0.6, "x2": -0.4666666666666667, "predicted node label": 27.70274151403969}, {"x1": -0.6, "x2": -0.33333333333333337, "predicted node label": 29.01586271505061}, {"x1": -0.6, "x2": -0.19999999999999996, "predicted node label": 26.256118808748266}, {"x1": -0.6, "x2": -0.06666666666666665, "predicted node label": 25.439390549857478}, {"x1": -0.6, "x2": 0.06666666666666665, "predicted node label": 23.737939371009837}, {"x1": -0.6, "x2": 0.19999999999999996, "predicted node label": 21.59937003226941}, {"x1": -0.6, "x2": 0.33333333333333326, "predicted node label": 22.097778719057327}, {"x1": -0.6, "x2": 0.46666666666666656, "predicted node label": 30.909790221952104}, {"x1": -0.6, "x2": 0.6000000000000001, "predicted node label": 37.793025789690084}, {"x1": -0.6, "x2": 0.7333333333333334, "predicted node label": 43.28421871100043}, {"x1": -0.6, "x2": 0.8666666666666667, "predicted node label": 42.95355898800571}, {"x1": -0.6, "x2": 1.0, "predicted node label": 31.088611789671024}, {"x1": -0.4666666666666667, "x2": -1.0, "predicted node label": 23.759625947936208}, {"x1": -0.4666666666666667, "x2": -0.8666666666666667, "predicted node label": 23.342028686955338}, {"x1": -0.4666666666666667, "x2": -0.7333333333333334, "predicted node label": 22.837863094807986}, {"x1": -0.4666666666666667, "x2": -0.6, "predicted node label": 21.796401584782238}, {"x1": -0.4666666666666667, "x2": -0.4666666666666667, "predicted node label": 20.723032531288574}, {"x1": -0.4666666666666667, "x2": -0.33333333333333337, "predicted node label": 20.3693243827978}, {"x1": -0.4666666666666667, "x2": -0.19999999999999996, "predicted node label": 20.387916728123027}, {"x1": -0.4666666666666667, "x2": -0.06666666666666665, "predicted node label": 20.922083259404854}, {"x1": -0.4666666666666667, "x2": 0.06666666666666665, "predicted node label": 21.323583801909837}, {"x1": -0.4666666666666667, "x2": 0.19999999999999996, "predicted node label": 20.533029944430513}, {"x1": -0.4666666666666667, "x2": 0.33333333333333326, "predicted node label": 21.572465304979165}, {"x1": -0.4666666666666667, "x2": 0.46666666666666656, "predicted node label": 28.17939581984846}, {"x1": -0.4666666666666667, "x2": 0.6000000000000001, "predicted node label": 39.29434520614608}, {"x1": -0.4666666666666667, "x2": 0.7333333333333334, "predicted node label": 43.310575455089946}, {"x1": -0.4666666666666667, "x2": 0.8666666666666667, "predicted node label": 40.35403176167225}, {"x1": -0.4666666666666667, "x2": 1.0, "predicted node label": 23.247298225559447}, {"x1": -0.33333333333333337, "x2": -1.0, "predicted node label": 24.99691596074583}, {"x1": -0.33333333333333337, "x2": -0.8666666666666667, "predicted node label": 23.974042245472894}, {"x1": -0.33333333333333337, "x2": -0.7333333333333334, "predicted node label": 22.392536834383062}, {"x1": -0.33333333333333337, "x2": -0.6, "predicted node label": 21.62302262559865}, {"x1": -0.33333333333333337, "x2": -0.4666666666666667, "predicted node label": 20.672107273312246}, {"x1": -0.33333333333333337, "x2": -0.33333333333333337, "predicted node label": 20.29791023894401}, {"x1": -0.33333333333333337, "x2": -0.19999999999999996, "predicted node label": 19.700945549437034}, {"x1": -0.33333333333333337, "x2": -0.06666666666666665, "predicted node label": 21.11300505537262}, {"x1": -0.33333333333333337, "x2": 0.06666666666666665, "predicted node label": 20.105325790400368}, {"x1": -0.33333333333333337, "x2": 0.19999999999999996, "predicted node label": 19.729909236866607}, {"x1": -0.33333333333333337, "x2": 0.33333333333333326, "predicted node label": 21.589639543582802}, {"x1": -0.33333333333333337, "x2": 0.46666666666666656, "predicted node label": 27.404911251819513}, {"x1": -0.33333333333333337, "x2": 0.6000000000000001, "predicted node label": 35.78738403602671}, {"x1": -0.33333333333333337, "x2": 0.7333333333333334, "predicted node label": 43.48390628865673}, {"x1": -0.33333333333333337, "x2": 0.8666666666666667, "predicted node label": 45.91287170026142}, {"x1": -0.33333333333333337, "x2": 1.0, "predicted node label": 45.33206947640459}, {"x1": -0.19999999999999996, "x2": -1.0, "predicted node label": 26.222764352785475}, {"x1": -0.19999999999999996, "x2": -0.8666666666666667, "predicted node label": 24.444493768470227}, {"x1": -0.19999999999999996, "x2": -0.7333333333333334, "predicted node label": 21.158502130016377}, {"x1": -0.19999999999999996, "x2": -0.6, "predicted node label": 21.932385461994897}, {"x1": -0.19999999999999996, "x2": -0.4666666666666667, "predicted node label": 20.33000617561505}, {"x1": -0.19999999999999996, "x2": -0.33333333333333337, "predicted node label": 15.640549337499705}, {"x1": -0.19999999999999996, "x2": -0.19999999999999996, "predicted node label": 14.844723240838674}, {"x1": -0.19999999999999996, "x2": -0.06666666666666665, "predicted node label": 15.445233194014605}, {"x1": -0.19999999999999996, "x2": 0.06666666666666665, "predicted node label": 17.130997319409097}, {"x1": -0.19999999999999996, "x2": 0.19999999999999996, "predicted node label": 18.877272654851744}, {"x1": -0.19999999999999996, "x2": 0.33333333333333326, "predicted node label": 20.197929572596262}, {"x1": -0.19999999999999996, "x2": 0.46666666666666656, "predicted node label": 23.56887312140293}, {"x1": -0.19999999999999996, "x2": 0.6000000000000001, "predicted node label": 29.361471746723925}, {"x1": -0.19999999999999996, "x2": 0.7333333333333334, "predicted node label": 41.82670283560884}, {"x1": -0.19999999999999996, "x2": 0.8666666666666667, "predicted node label": 49.91867571361442}, {"x1": -0.19999999999999996, "x2": 1.0, "predicted node label": 49.999028802666956}, {"x1": -0.06666666666666665, "x2": -1.0, "predicted node label": 22.85154143819064}, {"x1": -0.06666666666666665, "x2": -0.8666666666666667, "predicted node label": 23.8795672290372}, {"x1": -0.06666666666666665, "x2": -0.7333333333333334, "predicted node label": 21.31107600413828}, {"x1": -0.06666666666666665, "x2": -0.6, "predicted node label": 21.74649560688477}, {"x1": -0.06666666666666665, "x2": -0.4666666666666667, "predicted node label": 17.01838944611667}, {"x1": -0.06666666666666665, "x2": -0.33333333333333337, "predicted node label": 14.735669063851935}, {"x1": -0.06666666666666665, "x2": -0.19999999999999996, "predicted node label": 13.424423119268292}, {"x1": -0.06666666666666665, "x2": -0.06666666666666665, "predicted node label": 13.305111427688608}, {"x1": -0.06666666666666665, "x2": 0.06666666666666665, "predicted node label": 16.804342873519808}, {"x1": -0.06666666666666665, "x2": 0.19999999999999996, "predicted node label": 19.05779922444626}, {"x1": -0.06666666666666665, "x2": 0.33333333333333326, "predicted node label": 18.459364587966054}, {"x1": -0.06666666666666665, "x2": 0.46666666666666656, "predicted node label": 21.549540990112256}, {"x1": -0.06666666666666665, "x2": 0.6000000000000001, "predicted node label": 26.246283335130524}, {"x1": -0.06666666666666665, "x2": 0.7333333333333334, "predicted node label": 45.814834653209694}, {"x1": -0.06666666666666665, "x2": 0.8666666666666667, "predicted node label": 38.33682210495875}, {"x1": -0.06666666666666665, "x2": 1.0, "predicted node label": 35.0214101449784}, {"x1": 0.06666666666666665, "x2": -1.0, "predicted node label": 21.89153027857871}, {"x1": 0.06666666666666665, "x2": -0.8666666666666667, "predicted node label": 21.5829208101813}, {"x1": 0.06666666666666665, "x2": -0.7333333333333334, "predicted node label": 18.68641342749482}, {"x1": 0.06666666666666665, "x2": -0.6, "predicted node label": 22.928000906800065}, {"x1": 0.06666666666666665, "x2": -0.4666666666666667, "predicted node label": 20.99688554630157}, {"x1": 0.06666666666666665, "x2": -0.33333333333333337, "predicted node label": 18.448942175775}, {"x1": 0.06666666666666665, "x2": -0.19999999999999996, "predicted node label": 14.537034838619228}, {"x1": 0.06666666666666665, "x2": -0.06666666666666665, "predicted node label": 14.416766645500669}, {"x1": 0.06666666666666665, "x2": 0.06666666666666665, "predicted node label": 16.948573475186734}, {"x1": 0.06666666666666665, "x2": 0.19999999999999996, "predicted node label": 17.33630684179319}, {"x1": 0.06666666666666665, "x2": 0.33333333333333326, "predicted node label": 20.19025412925751}, {"x1": 0.06666666666666665, "x2": 0.46666666666666656, "predicted node label": 21.058241265470706}, {"x1": 0.06666666666666665, "x2": 0.6000000000000001, "predicted node label": 23.1260165710926}, {"x1": 0.06666666666666665, "x2": 0.7333333333333334, "predicted node label": 22.382720234771153}, {"x1": 0.06666666666666665, "x2": 0.8666666666666667, "predicted node label": 22.479579247468905}, {"x1": 0.06666666666666665, "x2": 1.0, "predicted node label": 22.210428367776206}, {"x1": 0.19999999999999996, "x2": -1.0, "predicted node label": 23.334516069942126}, {"x1": 0.19999999999999996, "x2": -0.8666666666666667, "predicted node label": 21.533433550709415}, {"x1": 0.19999999999999996, "x2": -0.7333333333333334, "predicted node label": 15.441130660040942}, {"x1": 0.19999999999999996, "x2": -0.6, "predicted node label": 13.660204514993644}, {"x1": 0.19999999999999996, "x2": -0.4666666666666667, "predicted node label": 21.689495658560247}, {"x1": 0.19999999999999996, "x2": -0.33333333333333337, "predicted node label": 22.94454121931026}, {"x1": 0.19999999999999996, "x2": -0.19999999999999996, "predicted node label": 15.484565882916238}, {"x1": 0.19999999999999996, "x2": -0.06666666666666665, "predicted node label": 14.381523809127836}, {"x1": 0.19999999999999996, "x2": 0.06666666666666665, "predicted node label": 14.575414759719848}, {"x1": 0.19999999999999996, "x2": 0.19999999999999996, "predicted node label": 16.37313422434769}, {"x1": 0.19999999999999996, "x2": 0.33333333333333326, "predicted node label": 18.893767020055755}, {"x1": 0.19999999999999996, "x2": 0.46666666666666656, "predicted node label": 20.85397910506877}, {"x1": 0.19999999999999996, "x2": 0.6000000000000001, "predicted node label": 20.407883379265897}, {"x1": 0.19999999999999996, "x2": 0.7333333333333334, "predicted node label": 20.133202603614347}, {"x1": 0.19999999999999996, "x2": 0.8666666666666667, "predicted node label": 15.797970794691333}, {"x1": 0.19999999999999996, "x2": 1.0, "predicted node label": 14.384250890303756}, {"x1": 0.33333333333333326, "x2": -1.0, "predicted node label": 22.355235616003565}, {"x1": 0.33333333333333326, "x2": -0.8666666666666667, "predicted node label": 24.695808417394005}, {"x1": 0.33333333333333326, "x2": -0.7333333333333334, "predicted node label": 11.725981250220677}, {"x1": 0.33333333333333326, "x2": -0.6, "predicted node label": 13.612981588106736}, {"x1": 0.33333333333333326, "x2": -0.4666666666666667, "predicted node label": 13.821377129106878}, {"x1": 0.33333333333333326, "x2": -0.33333333333333337, "predicted node label": 16.024340795600747}, {"x1": 0.33333333333333326, "x2": -0.19999999999999996, "predicted node label": 21.78091148853184}, {"x1": 0.33333333333333326, "x2": -0.06666666666666665, "predicted node label": 14.16680653052396}, {"x1": 0.33333333333333326, "x2": 0.06666666666666665, "predicted node label": 8.209045309586179}, {"x1": 0.33333333333333326, "x2": 0.19999999999999996, "predicted node label": 15.856056478532526}, {"x1": 0.33333333333333326, "x2": 0.33333333333333326, "predicted node label": 17.969381721538593}, {"x1": 0.33333333333333326, "x2": 0.46666666666666656, "predicted node label": 18.333151022956137}, {"x1": 0.33333333333333326, "x2": 0.6000000000000001, "predicted node label": 19.217746668458243}, {"x1": 0.33333333333333326, "x2": 0.7333333333333334, "predicted node label": 16.832579814845715}, {"x1": 0.33333333333333326, "x2": 0.8666666666666667, "predicted node label": 13.213584491357205}, {"x1": 0.33333333333333326, "x2": 1.0, "predicted node label": 13.155827610905659}, {"x1": 0.46666666666666656, "x2": -1.0, "predicted node label": 15.682380416959322}, {"x1": 0.46666666666666656, "x2": -0.8666666666666667, "predicted node label": 21.695507751092233}, {"x1": 0.46666666666666656, "x2": -0.7333333333333334, "predicted node label": 7.252418212553212}, {"x1": 0.46666666666666656, "x2": -0.6, "predicted node label": 9.181912374282795}, {"x1": 0.46666666666666656, "x2": -0.4666666666666667, "predicted node label": 13.61022336434076}, {"x1": 0.46666666666666656, "x2": -0.33333333333333337, "predicted node label": 13.798351782841914}, {"x1": 0.46666666666666656, "x2": -0.19999999999999996, "predicted node label": 13.768062404289504}, {"x1": 0.46666666666666656, "x2": -0.06666666666666665, "predicted node label": 9.077600423249427}, {"x1": 0.46666666666666656, "x2": 0.06666666666666665, "predicted node label": 8.179329693227086}, {"x1": 0.46666666666666656, "x2": 0.19999999999999996, "predicted node label": 15.564476490949183}, {"x1": 0.46666666666666656, "x2": 0.33333333333333326, "predicted node label": 18.689677677486735}, {"x1": 0.46666666666666656, "x2": 0.46666666666666656, "predicted node label": 18.328677752574784}, {"x1": 0.46666666666666656, "x2": 0.6000000000000001, "predicted node label": 18.38537410077254}, {"x1": 0.46666666666666656, "x2": 0.7333333333333334, "predicted node label": 19.982865765035335}, {"x1": 0.46666666666666656, "x2": 0.8666666666666667, "predicted node label": 14.014398251225316}, {"x1": 0.46666666666666656, "x2": 1.0, "predicted node label": 13.7677077827886}, {"x1": 0.6000000000000001, "x2": -1.0, "predicted node label": 13.972568128521873}, {"x1": 0.6000000000000001, "x2": -0.8666666666666667, "predicted node label": 23.061069386097145}, {"x1": 0.6000000000000001, "x2": -0.7333333333333334, "predicted node label": 16.374805387264317}, {"x1": 0.6000000000000001, "x2": -0.6, "predicted node label": 14.805298497623053}, {"x1": 0.6000000000000001, "x2": -0.4666666666666667, "predicted node label": 22.906269306823276}, {"x1": 0.6000000000000001, "x2": -0.33333333333333337, "predicted node label": 22.96996711001254}, {"x1": 0.6000000000000001, "x2": -0.19999999999999996, "predicted node label": 18.60549754423466}, {"x1": 0.6000000000000001, "x2": -0.06666666666666665, "predicted node label": 7.515585770700259}, {"x1": 0.6000000000000001, "x2": 0.06666666666666665, "predicted node label": 10.402439857723909}, {"x1": 0.6000000000000001, "x2": 0.19999999999999996, "predicted node label": 15.283879024676905}, {"x1": 0.6000000000000001, "x2": 0.33333333333333326, "predicted node label": 19.002211415316147}, {"x1": 0.6000000000000001, "x2": 0.46666666666666656, "predicted node label": 19.06832836964707}, {"x1": 0.6000000000000001, "x2": 0.6000000000000001, "predicted node label": 22.675030660582806}, {"x1": 0.6000000000000001, "x2": 0.7333333333333334, "predicted node label": 22.92076912552097}, {"x1": 0.6000000000000001, "x2": 0.8666666666666667, "predicted node label": 15.216246379430133}, {"x1": 0.6000000000000001, "x2": 1.0, "predicted node label": 14.337430509887886}, {"x1": 0.7333333333333334, "x2": -1.0, "predicted node label": 12.450484060191055}, {"x1": 0.7333333333333334, "x2": -0.8666666666666667, "predicted node label": 8.76943485548207}, {"x1": 0.7333333333333334, "x2": -0.7333333333333334, "predicted node label": 16.3008245422857}, {"x1": 0.7333333333333334, "x2": -0.6, "predicted node label": 22.970768558450008}, {"x1": 0.7333333333333334, "x2": -0.4666666666666667, "predicted node label": 22.97079646017699}, {"x1": 0.7333333333333334, "x2": -0.33333333333333337, "predicted node label": 22.97079646017699}, {"x1": 0.7333333333333334, "x2": -0.19999999999999996, "predicted node label": 22.97079646017699}, {"x1": 0.7333333333333334, "x2": -0.06666666666666665, "predicted node label": 22.617562778991328}, {"x1": 0.7333333333333334, "x2": 0.06666666666666665, "predicted node label": 9.505338875234926}, {"x1": 0.7333333333333334, "x2": 0.19999999999999996, "predicted node label": 15.041385433800485}, {"x1": 0.7333333333333334, "x2": 0.33333333333333326, "predicted node label": 19.194806365770543}, {"x1": 0.7333333333333334, "x2": 0.46666666666666656, "predicted node label": 21.882784546427416}, {"x1": 0.7333333333333334, "x2": 0.6000000000000001, "predicted node label": 22.94464522920872}, {"x1": 0.7333333333333334, "x2": 0.7333333333333334, "predicted node label": 18.068901574292006}, {"x1": 0.7333333333333334, "x2": 0.8666666666666667, "predicted node label": 16.893573356831816}, {"x1": 0.7333333333333334, "x2": 1.0, "predicted node label": 17.31889118273881}, {"x1": 0.8666666666666667, "x2": -1.0, "predicted node label": 8.988282844206669}, {"x1": 0.8666666666666667, "x2": -0.8666666666666667, "predicted node label": 7.817364470719995}, {"x1": 0.8666666666666667, "x2": -0.7333333333333334, "predicted node label": 10.955842013752683}, {"x1": 0.8666666666666667, "x2": -0.6, "predicted node label": 22.94606029726062}, {"x1": 0.8666666666666667, "x2": -0.4666666666666667, "predicted node label": 22.97065096518438}, {"x1": 0.8666666666666667, "x2": -0.33333333333333337, "predicted node label": 18.239243950743454}, {"x1": 0.8666666666666667, "x2": -0.19999999999999996, "predicted node label": 22.970790392230214}, {"x1": 0.8666666666666667, "x2": -0.06666666666666665, "predicted node label": 22.97079646017699}, {"x1": 0.8666666666666667, "x2": 0.06666666666666665, "predicted node label": 10.877734749348146}, {"x1": 0.8666666666666667, "x2": 0.19999999999999996, "predicted node label": 15.308198697894959}, {"x1": 0.8666666666666667, "x2": 0.33333333333333326, "predicted node label": 19.26493624120463}, {"x1": 0.8666666666666667, "x2": 0.46666666666666656, "predicted node label": 22.789048405990258}, {"x1": 0.8666666666666667, "x2": 0.6000000000000001, "predicted node label": 22.970200907960805}, {"x1": 0.8666666666666667, "x2": 0.7333333333333334, "predicted node label": 19.25240418742438}, {"x1": 0.8666666666666667, "x2": 0.8666666666666667, "predicted node label": 25.142393631998097}, {"x1": 0.8666666666666667, "x2": 1.0, "predicted node label": 34.056938588224476}, {"x1": 1.0, "x2": -1.0, "predicted node label": 7.85242228221784}, {"x1": 1.0, "x2": -0.8666666666666667, "predicted node label": 7.3653406958751075}, {"x1": 1.0, "x2": -0.7333333333333334, "predicted node label": 13.153844787189408}, {"x1": 1.0, "x2": -0.6, "predicted node label": 22.955708219391184}, {"x1": 1.0, "x2": -0.4666666666666667, "predicted node label": 11.191836198138123}, {"x1": 1.0, "x2": -0.33333333333333337, "predicted node label": 10.40042644864298}, {"x1": 1.0, "x2": -0.19999999999999996, "predicted node label": 12.151099984700869}, {"x1": 1.0, "x2": -0.06666666666666665, "predicted node label": 22.97079646017699}, {"x1": 1.0, "x2": 0.06666666666666665, "predicted node label": 12.796830671791882}, {"x1": 1.0, "x2": 0.19999999999999996, "predicted node label": 14.988382787492922}, {"x1": 1.0, "x2": 0.33333333333333326, "predicted node label": 18.99113347838638}, {"x1": 1.0, "x2": 0.46666666666666656, "predicted node label": 22.965332436275045}, {"x1": 1.0, "x2": 0.6000000000000001, "predicted node label": 22.970763651685225}, {"x1": 1.0, "x2": 0.7333333333333334, "predicted node label": 26.135114922355754}, {"x1": 1.0, "x2": 0.8666666666666667, "predicted node label": 42.309841069660045}, {"x1": 1.0, "x2": 1.0, "predicted node label": 33.5941142226276}]}};
      var opt = {
        "mode": "vega-lite",
        "renderer": "canvas",
        "actions": {"editor": false, "source": false, "export": false}
      };
      vegaEmbed('#eGTR_regressor-rst-altair-plot-0', spec, opt).catch(console.err);
  });
</script>
</div></div>
<div class="section" id="visualize-predicted-vs-real-labels">
<h2>Visualize predicted vs real labels<a class="headerlink" href="#visualize-predicted-vs-real-labels" title="Permalink to this headline">¶</a></h2>
<p>This visualization uses the python package <a class="reference external" href="https://altair-viz.github.io">altair</a>:</p>
<div class="highlight-python notranslate" id="eGTR_regressor-rst-altair-source-1"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ugtm</span> <span class="kn">import</span> <span class="n">eGTM</span><span class="p">,</span> <span class="n">eGTR</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">preprocessing</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">decomposition</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">model_selection</span>

<span class="n">boston</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_boston</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">boston</span><span class="o">.</span><span class="n">data</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">boston</span><span class="o">.</span><span class="n">target</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.33</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># optional preprocessing</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">StandardScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Predict labels for X_test</span>
<span class="n">gtr</span> <span class="o">=</span> <span class="n">eGTR</span><span class="p">()</span>
<span class="n">gtr</span> <span class="o">=</span> <span class="n">gtr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">gtr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Get GTM transform for X_test</span>
<span class="n">transformed</span> <span class="o">=</span> <span class="n">eGTM</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">transformed</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;x1&quot;</span><span class="p">,</span> <span class="s2">&quot;x2&quot;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;predicted label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_pred</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;true label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_test</span>

<span class="n">chart1</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
<span class="n">x</span><span class="o">=</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;x2&#39;</span><span class="p">,</span>
<span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">&quot;predicted label:Q&quot;</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">scheme</span><span class="o">=</span><span class="s1">&#39;greenblue&#39;</span><span class="p">),</span>
                 <span class="n">legend</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Boston house prices&quot;</span><span class="p">)),</span>
<span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;x1&quot;</span><span class="p">,</span> <span class="s2">&quot;x2&quot;</span><span class="p">,</span> <span class="s2">&quot;predicted label:Q&quot;</span><span class="p">,</span> <span class="s2">&quot;true label:Q&quot;</span><span class="p">]</span>
<span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Pedicted labels&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>

<span class="n">chart2</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
<span class="n">x</span><span class="o">=</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;x2&#39;</span><span class="p">,</span>
<span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">&quot;true label:Q&quot;</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">scheme</span><span class="o">=</span><span class="s1">&#39;greenblue&#39;</span><span class="p">),</span>
                <span class="n">legend</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Boston house prices&quot;</span><span class="p">)),</span>
<span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;x1&quot;</span><span class="p">,</span> <span class="s2">&quot;x2&quot;</span><span class="p">,</span> <span class="s2">&quot;predicted label:Q&quot;</span><span class="p">,</span> <span class="s2">&quot;true label:Q&quot;</span><span class="p">]</span>
<span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;True labels&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>

<span class="n">alt</span><span class="o">.</span><span class="n">hconcat</span><span class="p">(</span><span class="n">chart1</span><span class="p">,</span> <span class="n">chart2</span><span class="p">)</span>
</pre></div>
</div>

<div id="eGTR_regressor-rst-altair-plot-1">
<script>
  // embed when document is loaded, to ensure vega library is available
  // this works on all modern browsers, except IE8 and older
  document.addEventListener("DOMContentLoaded", function(event) {
      var spec = {"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "hconcat": [{"mark": "point", "encoding": {"color": {"type": "quantitative", "field": "predicted label", "legend": {"title": "Boston house prices"}, "scale": {"scheme": "greenblue"}}, "tooltip": [{"type": "quantitative", "field": "x1"}, {"type": "quantitative", "field": "x2"}, {"type": "quantitative", "field": "predicted label"}, {"type": "quantitative", "field": "true label"}], "x": {"type": "quantitative", "field": "x1"}, "y": {"type": "quantitative", "field": "x2"}}, "height": 200, "selection": {"selector004": {"type": "interval", "bind": "scales", "encodings": ["x", "y"]}}, "title": "Pedicted labels", "width": 200}, {"mark": "point", "encoding": {"color": {"type": "quantitative", "field": "true label", "legend": {"title": "Boston house prices"}, "scale": {"scheme": "greenblue"}}, "tooltip": [{"type": "quantitative", "field": "x1"}, {"type": "quantitative", "field": "x2"}, {"type": "quantitative", "field": "predicted label"}, {"type": "quantitative", "field": "true label"}], "x": {"type": "quantitative", "field": "x1"}, "y": {"type": "quantitative", "field": "x2"}}, "height": 200, "selection": {"selector005": {"type": "interval", "bind": "scales", "encodings": ["x", "y"]}}, "title": "True labels", "width": 200}], "data": {"name": "data-29667135b1a729c50d6dd846a55dbeb3"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-29667135b1a729c50d6dd846a55dbeb3": [{"x1": -0.2738980091954363, "x2": 0.47159034086110785, "predicted label": 27.40491125181624, "true label": 23.6}, {"x1": -0.8682985322025092, "x2": 0.7347143971992024, "predicted label": 32.66645308378216, "true label": 32.4}, {"x1": 0.4544440033616618, "x2": 0.28327394490435376, "predicted label": 18.68967767748633, "true label": 13.6}, {"x1": -0.33289053333163365, "x2": -0.961161842113772, "predicted label": 24.996915960745135, "true label": 22.8}, {"x1": 0.8689181435817646, "x2": 0.18264199212337667, "predicted label": 15.308198697894806, "true label": 16.1}, {"x1": -0.27904559051530237, "x2": 0.16889394818108902, "predicted label": 20.19792957259528, "true label": 20.0}, {"x1": -0.26040068354779045, "x2": -0.08706786234355846, "predicted label": 21.113005055372515, "true label": 17.8}, {"x1": 0.2608860302238938, "x2": 0.1824797226289099, "predicted label": 16.37313422434668, "true label": 14.0}, {"x1": 0.27857114506118663, "x2": -0.9348627813003308, "predicted label": 22.355235616004116, "true label": 19.6}, {"x1": -0.18093641985552464, "x2": 0.20225687970084827, "predicted label": 18.877272654851847, "true label": 16.8}, {"x1": -0.9993711049083088, "x2": 0.8806384345599805, "predicted label": 22.661217944549918, "true label": 21.5}, {"x1": -0.3449261620649982, "x2": -0.34563922360201704, "predicted label": 20.29791023894405, "true label": 18.9}, {"x1": 0.7429505982340443, "x2": -0.609818303931403, "predicted label": 22.970768558445414, "true label": 7.0}, {"x1": -0.22033152617685042, "x2": -0.6960065906120196, "predicted label": 21.158502130018224, "true label": 21.2}, {"x1": -0.35962935908222315, "x2": 0.12879953631805052, "predicted label": 20.105325790401054, "true label": 18.5}, {"x1": 0.30131710528284605, "x2": -0.9993414608971215, "predicted label": 22.355235616004116, "true label": 29.8}, {"x1": 0.17522016579168354, "x2": 0.3805409931690368, "predicted label": 20.853979105067666, "true label": 18.8}, {"x1": 0.416001295395306, "x2": -0.6002923984780567, "predicted label": 9.18191237428529, "true label": 10.2}, {"x1": -0.9709099506378039, "x2": -0.2740437608933672, "predicted label": 42.76178702103743, "true label": 50.0}, {"x1": 0.8863877847497589, "x2": 0.19444928271874484, "predicted label": 15.308198697894806, "true label": 14.1}, {"x1": -0.3932493140000143, "x2": -0.9704215784028981, "predicted label": 24.996915960745135, "true label": 25.2}, {"x1": -0.6594032393770821, "x2": -0.10212103656620257, "predicted label": 25.439390549857936, "true label": 29.1}, {"x1": -0.18384513824408688, "x2": -0.021107845855924543, "predicted label": 15.445233194014268, "true label": 12.7}, {"x1": -0.15824416144397357, "x2": 0.35746573719044783, "predicted label": 20.19792957259528, "true label": 22.4}, {"x1": 0.7104921759094851, "x2": -0.20261240030532524, "predicted label": 15.308198697894806, "true label": 14.2}, {"x1": 0.34733141795198963, "x2": -0.7976036232619634, "predicted label": 24.69580841739223, "true label": 13.8}, {"x1": -0.19900747615465592, "x2": -0.8478171744058278, "predicted label": 24.444493768468377, "true label": 20.3}, {"x1": 0.7449516257800541, "x2": -0.9999942613328922, "predicted label": 12.450484060191911, "true label": 14.9}, {"x1": -0.9996355172078586, "x2": 0.8444647426728497, "predicted label": 22.661217944549918, "true label": 21.7}, {"x1": -0.19319255904291205, "x2": 0.02424647439853655, "predicted label": 18.877272654851847, "true label": 18.3}, {"x1": -0.32489848789397124, "x2": -0.12898034722035379, "predicted label": 21.113005055372515, "true label": 23.1}, {"x1": -0.4899624750632075, "x2": 0.32735896984517154, "predicted label": 21.57246530497858, "true label": 23.8}, {"x1": 0.9796779470503146, "x2": 0.14245325873919784, "predicted label": 14.988382787493101, "true label": 15.0}, {"x1": 0.33878076801387635, "x2": -0.8516627274361149, "predicted label": 24.69580841739223, "true label": 20.8}, {"x1": 0.6608809018761933, "x2": -0.09754267743221862, "predicted label": 15.041385433797371, "true label": 19.1}, {"x1": 0.20032961528337997, "x2": 0.8647373410712033, "predicted label": 15.797970794693772, "true label": 19.4}, {"x1": -0.46986168566005165, "x2": 0.5638568695671794, "predicted label": 39.29434520614411, "true label": 34.7}, {"x1": -0.5083344326318202, "x2": 0.2452006042021951, "predicted label": 20.5330299444311, "true label": 19.5}, {"x1": -0.9993057155224568, "x2": 0.7364434168076691, "predicted label": 21.87638305217201, "true label": 24.4}, {"x1": -0.3343507600347937, "x2": -0.9667730793715905, "predicted label": 24.996915960745135, "true label": 23.4}, {"x1": -0.0953151321137713, "x2": -0.4423110001344802, "predicted label": 21.746495606884878, "true label": 19.7}, {"x1": -0.4632654450203837, "x2": 0.40977441967348593, "predicted label": 28.179395819844746, "true label": 28.2}, {"x1": -0.9975230450901186, "x2": -0.3085823772638308, "predicted label": 47.65251997537814, "true label": 50.0}, {"x1": -0.45246704219656675, "x2": -0.4845392304895665, "predicted label": 22.392536834383314, "true label": 17.4}, {"x1": -0.3767357821411266, "x2": 0.40565556670123554, "predicted label": 27.40491125181624, "true label": 22.6}, {"x1": 0.6522253239928172, "x2": -0.16530072205556895, "predicted label": 15.308198697894806, "true label": 15.1}, {"x1": -0.19328784202421412, "x2": 0.06434749490965588, "predicted label": 17.130997319410078, "true label": 13.1}, {"x1": -0.3302263626288016, "x2": -0.9778433768845844, "predicted label": 24.996915960745135, "true label": 24.2}, {"x1": 0.29580695054413764, "x2": -0.8273991509522686, "predicted label": 24.69580841739223, "true label": 19.9}, {"x1": -0.55036976715421, "x2": -0.15964260605200023, "predicted label": 26.256118808747807, "true label": 24.0}, {"x1": -0.4050516386118806, "x2": -0.3276554347530756, "predicted label": 20.369324382798, "true label": 18.9}, {"x1": -0.6103680010530899, "x2": -0.30735183995987087, "predicted label": 29.015862715049874, "true label": 35.4}, {"x1": -0.20827320313340583, "x2": 0.09111344465416026, "predicted label": 17.130997319410078, "true label": 15.2}, {"x1": -0.2553505953081761, "x2": 0.4036328674855527, "predicted label": 23.568873121401033, "true label": 26.5}, {"x1": -0.19975797317034655, "x2": 0.8198372947278234, "predicted label": 49.91867571360987, "true label": 43.5}, {"x1": 0.21483323794182788, "x2": -0.9868767831964389, "predicted label": 23.334516069941316, "true label": 21.2}, {"x1": 0.880489807630135, "x2": 0.1955833645668528, "predicted label": 15.308198697894806, "true label": 18.4}, {"x1": -0.9818636277392105, "x2": -0.010351797676503086, "predicted label": 32.35383805209891, "true label": 28.5}, {"x1": -0.5285757854428423, "x2": 0.2396657351517082, "predicted label": 22.097778719057047, "true label": 23.9}, {"x1": -0.36337726859164954, "x2": -0.2864901842723761, "predicted label": 20.29791023894405, "true label": 18.5}, {"x1": -0.8609064856925837, "x2": 0.3020727829847517, "predicted label": 26.483513549521422, "true label": 25.0}, {"x1": -0.9885459868675479, "x2": -0.6691369166500404, "predicted label": 26.606108214891545, "true label": 35.4}, {"x1": -0.21359408310242345, "x2": -0.9852496627169929, "predicted label": 26.222764352784477, "true label": 31.5}, {"x1": -0.3583959935027689, "x2": 0.07530310681636476, "predicted label": 19.72990923686706, "true label": 20.2}, {"x1": -0.8906634777621311, "x2": -0.8560621134891669, "predicted label": 19.50382754328408, "true label": 24.1}, {"x1": -0.9999991180874069, "x2": 0.8631864953773942, "predicted label": 22.661217944549918, "true label": 20.0}, {"x1": 0.9184239799695851, "x2": 0.1987394491498424, "predicted label": 15.308198697894806, "true label": 13.1}, {"x1": -0.6651187523114063, "x2": 0.06931148723825416, "predicted label": 25.026940611404164, "true label": 24.8}, {"x1": -0.9307441334147998, "x2": -0.08947517118254346, "predicted label": 32.35383805209891, "true label": 30.8}, {"x1": 0.7396863311268632, "x2": -0.999999847473274, "predicted label": 12.450484060191911, "true label": 12.7}, {"x1": -0.32353791136456156, "x2": -0.7111669838256566, "predicted label": 22.392536834383314, "true label": 20.0}, {"x1": 0.23649565944139872, "x2": -0.9999019885650554, "predicted label": 23.334516069941316, "true label": 23.7}, {"x1": 0.575335111360538, "x2": -0.8443088403470125, "predicted label": 23.061069386092033, "true label": 10.8}, {"x1": -0.9551525561867508, "x2": -0.9910111586166295, "predicted label": 18.628487195712715, "true label": 20.6}, {"x1": -0.18392038814933032, "x2": -0.8234980515759827, "predicted label": 24.444493768468377, "true label": 20.8}, {"x1": 0.6070220768669176, "x2": -0.2811035293099196, "predicted label": 18.60549754422842, "true label": 5.0}, {"x1": -0.18777895840697814, "x2": 0.25460123557576847, "predicted label": 18.877272654851847, "true label": 20.1}, {"x1": -0.9950916704588721, "x2": -0.32129038347149697, "predicted label": 47.65251997537814, "true label": 48.5}, {"x1": 0.9251634765325392, "x2": 0.1839066178784628, "predicted label": 14.988382787493101, "true label": 10.9}, {"x1": 0.4092542685263541, "x2": 0.16846984386160277, "predicted label": 15.564476490949348, "true label": 7.0}, {"x1": -0.5934929692482349, "x2": -0.20406171451023566, "predicted label": 22.424569133034606, "true label": 20.9}, {"x1": 0.3565352039678411, "x2": -0.7300242096242661, "predicted label": 11.725981250222768, "true label": 17.2}, {"x1": -0.8747278862868695, "x2": -0.7552130410676339, "predicted label": 23.44167431283709, "true label": 20.9}, {"x1": 0.344307125471529, "x2": -0.7244592734108513, "predicted label": 11.725981250222768, "true label": 9.7}, {"x1": -0.20708690089372125, "x2": 0.25679402847562094, "predicted label": 20.19792957259528, "true label": 19.4}, {"x1": -0.8696184940257101, "x2": 0.8525533530983975, "predicted label": 25.96931319689485, "true label": 29.0}, {"x1": 0.5118487486838283, "x2": -0.9593267518734884, "predicted label": 15.682380416963076, "true label": 16.4}, {"x1": -0.4977091464845938, "x2": 0.10174651208920943, "predicted label": 22.097778719057047, "true label": 25.0}, {"x1": -0.2587242319044788, "x2": -0.9699458792079492, "predicted label": 26.222764352784477, "true label": 25.0}, {"x1": 0.22030967747419092, "x2": 0.3201286626350665, "predicted label": 18.893767020054337, "true label": 17.1}, {"x1": -0.3043098133572324, "x2": -0.6073105049621904, "predicted label": 21.62302262559875, "true label": 23.2}, {"x1": 0.718285414298818, "x2": -0.736614328464813, "predicted label": 16.300824542285742, "true label": 10.4}, {"x1": 0.19841730319064568, "x2": 0.3350665969286008, "predicted label": 18.893767020054337, "true label": 19.6}, {"x1": -0.5902456434706135, "x2": 0.1041147747604767, "predicted label": 21.599370032270613, "true label": 17.2}, {"x1": 0.3182090996799339, "x2": -0.7401330502393998, "predicted label": 11.725981250222768, "true label": 27.5}, {"x1": 0.18948997382106025, "x2": 0.3424561880088927, "predicted label": 18.893767020054337, "true label": 23.0}, {"x1": 0.3862739985804255, "x2": -0.8901842522444479, "predicted label": 22.355235616004116, "true label": 50.0}, {"x1": 0.8480309750595979, "x2": -0.8666668073896704, "predicted label": 7.8173644707205305, "true label": 17.9}, {"x1": 0.7406291209197332, "x2": -0.978110343952945, "predicted label": 12.450484060191911, "true label": 9.6}, {"x1": 0.7416301487582333, "x2": -0.9869898128631461, "predicted label": 12.450484060191911, "true label": 17.2}, {"x1": -0.41217989164675795, "x2": -0.18201223265128125, "predicted label": 20.5330299444311, "true label": 22.5}, {"x1": -0.19185599169573042, "x2": -0.8681548720722866, "predicted label": 24.444493768468377, "true label": 21.4}, {"x1": 0.4569147028543719, "x2": -0.7311653966544728, "predicted label": 7.252418212555728, "true label": 12.0}, {"x1": -0.4107144126417527, "x2": 0.24042461610071997, "predicted label": 20.5330299444311, "true label": 19.9}, {"x1": -0.5859059128550734, "x2": -0.7688196290291446, "predicted label": 22.40199639175625, "true label": 19.4}, {"x1": 0.7982869720298573, "x2": -0.9999981285650742, "predicted label": 12.450484060191911, "true label": 13.4}, {"x1": -0.29954499780918914, "x2": 0.20167945928384595, "predicted label": 19.72990923686706, "true label": 18.2}, {"x1": -0.31710892280081204, "x2": -0.9614217833965671, "predicted label": 24.996915960745135, "true label": 24.6}, {"x1": -0.610953579921293, "x2": 0.28866581673821606, "predicted label": 22.097778719057047, "true label": 21.1}, {"x1": -0.9628870311911311, "x2": -0.7369374263756485, "predicted label": 26.606108214891545, "true label": 24.7}, {"x1": 0.8644242690854632, "x2": -0.8844342876062693, "predicted label": 7.8173644707205305, "true label": 8.7}, {"x1": 0.6011069844032849, "x2": -0.9636698129891912, "predicted label": 13.972568128526985, "true label": 27.5}, {"x1": -0.6408184103742118, "x2": 0.3284578674462824, "predicted label": 22.097778719057047, "true label": 20.7}, {"x1": -0.39222994577217685, "x2": 0.3233240640661323, "predicted label": 21.58963954358279, "true label": 36.2}, {"x1": -0.2616680272099546, "x2": 0.5897022578852241, "predicted label": 29.36147174673094, "true label": 31.6}, {"x1": 0.7038641942133614, "x2": -0.926859614288795, "predicted label": 8.769434855490108, "true label": 11.7}, {"x1": -0.33606872052685854, "x2": 0.6015477781421139, "predicted label": 35.78738403602868, "true label": 39.8}, {"x1": -0.22330758420999317, "x2": 0.08420803662874009, "predicted label": 17.130997319410078, "true label": 13.9}, {"x1": -0.09075292284760787, "x2": -0.6354727130430817, "predicted label": 21.311076004138194, "true label": 21.8}, {"x1": -0.6081020760426015, "x2": -0.5466002336220107, "predicted label": 22.40199639175625, "true label": 23.7}, {"x1": -0.4985111155964244, "x2": -0.0024140969585018934, "predicted label": 20.922083259404552, "true label": 17.6}, {"x1": -0.8616136317061343, "x2": 0.22980871767256755, "predicted label": 25.35324935540098, "true label": 24.4}, {"x1": 0.9999918954945257, "x2": -0.5999999999689228, "predicted label": 22.955708219391173, "true label": 8.8}, {"x1": -0.16322523328308125, "x2": 0.3411130536719183, "predicted label": 20.19792957259528, "true label": 19.2}, {"x1": -0.37192696195657077, "x2": -0.9319090873982964, "predicted label": 23.974042245472543, "true label": 25.3}, {"x1": -0.48308419222989185, "x2": 0.239216805453146, "predicted label": 21.57246530497858, "true label": 20.4}, {"x1": -0.9741894616215467, "x2": -0.7346652500105174, "predicted label": 26.606108214891545, "true label": 23.1}, {"x1": -0.3117311258448277, "x2": 0.5870887916563232, "predicted label": 35.78738403602868, "true label": 37.9}, {"x1": 0.6000528714633209, "x2": 0.9992862830417242, "predicted label": 14.33743050988838, "true label": 15.6}, {"x1": -0.38805215715299235, "x2": 0.7326242311544747, "predicted label": 43.483906288652406, "true label": 45.4}, {"x1": 0.12250506716741248, "x2": 0.07552101107435107, "predicted label": 16.9485734751854, "true label": 15.7}, {"x1": -0.34218974645709976, "x2": -0.862961673787138, "predicted label": 23.974042245472543, "true label": 22.6}, {"x1": -0.23135135654809383, "x2": 0.17956055610813665, "predicted label": 18.877272654851847, "true label": 14.5}, {"x1": -0.19959997091909693, "x2": 0.01046028296948397, "predicted label": 17.130997319410078, "true label": 18.7}, {"x1": 0.2216664720819298, "x2": 0.9580751371478687, "predicted label": 14.384250890304552, "true label": 17.8}, {"x1": 0.6110454213714305, "x2": -0.9999985880954225, "predicted label": 13.972568128526985, "true label": 16.1}, {"x1": -0.5394971698407197, "x2": 0.2646256852646254, "predicted label": 22.097778719057047, "true label": 20.6}, {"x1": -0.9792075692781503, "x2": -0.5993676574665758, "predicted label": 32.58064913174789, "true label": 31.6}, {"x1": -0.7561777603267725, "x2": -0.46242840355991693, "predicted label": 24.83403002904404, "true label": 29.1}, {"x1": -0.22494059500150038, "x2": 0.10324209818290353, "predicted label": 17.130997319410078, "true label": 15.6}, {"x1": -0.26739942779461495, "x2": 0.15630106792474338, "predicted label": 18.877272654851847, "true label": 17.5}, {"x1": -0.8174763495542309, "x2": -0.604746351573595, "predicted label": 26.312967404440354, "true label": 22.5}, {"x1": -0.8441855709531702, "x2": -0.7076504997314685, "predicted label": 23.44167431283709, "true label": 19.4}, {"x1": -0.9999990240473016, "x2": 0.8592176360331161, "predicted label": 22.661217944549918, "true label": 19.3}, {"x1": 0.6709865610669858, "x2": -0.33286715742758466, "predicted label": 22.617562778982833, "true label": 8.5}, {"x1": -0.3150958803490203, "x2": 0.1465233131759217, "predicted label": 20.922083259404552, "true label": 20.6}, {"x1": 0.6102186059923992, "x2": 0.9975011909811524, "predicted label": 14.33743050988838, "true label": 17.0}, {"x1": 0.9237735591503673, "x2": 0.19975100932096101, "predicted label": 15.308198697894806, "true label": 17.1}, {"x1": -0.18978955932579533, "x2": 0.0329535646711879, "predicted label": 17.130997319410078, "true label": 14.5}, {"x1": -0.3302338041401064, "x2": 0.7369797700566523, "predicted label": 43.483906288652406, "true label": 50.0}, {"x1": 0.6845129999704993, "x2": -0.9999959265153164, "predicted label": 12.450484060191911, "true label": 14.3}, {"x1": 0.9087846510532708, "x2": 0.19512403094833353, "predicted label": 15.308198697894806, "true label": 12.6}, {"x1": -0.5912118088285336, "x2": 0.35699168555868693, "predicted label": 22.097778719057047, "true label": 28.7}, {"x1": -0.16582337733952696, "x2": 0.1602777322745829, "predicted label": 20.19792957259528, "true label": 21.2}, {"x1": -0.33084900446036325, "x2": -0.7567833710018637, "predicted label": 22.392536834383314, "true label": 19.3}, {"x1": -0.27665238196865105, "x2": -0.7040181105389787, "predicted label": 26.222764352784477, "true label": 23.1}, {"x1": 0.3740316829956312, "x2": -0.8521951954842758, "predicted label": 24.69580841739223, "true label": 19.1}, {"x1": 0.3468354961417675, "x2": -0.9746817693244575, "predicted label": 22.355235616004116, "true label": 25.0}, {"x1": -0.602754919508269, "x2": 0.45372282650362483, "predicted label": 30.909790221947148, "true label": 33.4}, {"x1": 0.7674997932022902, "x2": -0.3020908088263053, "predicted label": 22.97079646017699, "true label": 5.0}, {"x1": -0.40988013860699796, "x2": 0.11684435062510846, "predicted label": 21.323583801909393, "true label": 29.6}, {"x1": -0.5733992483161894, "x2": 0.14456523214084158, "predicted label": 21.599370032270613, "true label": 18.7}, {"x1": -0.28017456684067665, "x2": 0.2489544630744108, "predicted label": 19.72990923686706, "true label": 21.7}, {"x1": -0.48263074566240194, "x2": 0.32350461382983114, "predicted label": 21.57246530497858, "true label": 23.1}, {"x1": 0.06389145850072439, "x2": 0.8876276081730012, "predicted label": 22.47957924746885, "true label": 22.8}, {"x1": -0.2684849838597815, "x2": 0.2948240805347627, "predicted label": 20.19792957259528, "true label": 21.0}, {"x1": -0.1990022658701263, "x2": 0.9835139076152345, "predicted label": 49.999028802666906, "true label": 48.8}]}};
      var opt = {
        "mode": "vega-lite",
        "renderer": "canvas",
        "actions": {"editor": false, "source": false, "export": false}
      };
      vegaEmbed('#eGTR_regressor-rst-altair-plot-1', spec, opt).catch(console.err);
  });
</script>
</div></div>
<div class="section" id="parameter-optimization">
<h2>Parameter optimization<a class="headerlink" href="#parameter-optimization" title="Permalink to this headline">¶</a></h2>
<p>GridSearchCV from sklearn can be used with eGTC for parameter optimization:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ugtm</span> <span class="kn">import</span> <span class="n">eGTR</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>

<span class="c1"># Dummy train and test</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># Parameters to tune</span>
<span class="n">tuned_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;regul&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0001</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span>
                <span class="s1">&#39;s&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span>
                <span class="s1">&#39;k&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">16</span><span class="p">],</span>
                <span class="s1">&#39;m&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">]}</span>

<span class="c1"># GTM classifier (GTR)</span>
<span class="n">gs</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">eGTR</span><span class="p">(),</span> <span class="n">tuned_params</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">iid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;r2&#39;</span><span class="p">)</span>
<span class="n">gs</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">gs</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="api.html" class="btn btn-neutral float-right" title="API Reference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="eGTC_classifier.html" class="btn btn-neutral float-left" title="eGTC: GTM classifier" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2018, Helena A. Gaspar.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>